$Header: /u/gcmpack/MITgcm/doc/tag-index,v 1.697 2006/07/12 00:01:53 heimbach Exp $
$Name:  $

    Notes on tags used in MITgcmUV
    ==============================

checkpoint58l_post
o take bi,bj loops outside calc_gw to fix Pb with local array KappaRU,V
o commit code to make SST/SSS weights spatially variable
  (based on either variable in-situ or variable initial T/S weights)
o pkg/ecco:
  * commit code to relax deviations of xx_theta, xx_salt to 5*sigma,
    now based on horizontally varying weights wthetaLev, wsaltLev
  * cost_averagesflags now returns year indices in addition to day, month
  * sflux balance is performed on annual basis 
    (sflxumm, sfluxmm2, bal_sfluxmm)
  * for SSH anomaly, separate more cleanly contrib from T/P, ERS, GFO,
    including separate counting and multipliers
o pkg/rbcs
  * add all necessary infrastructure for pkg/rbcs levN adjoint checkpointing

checkpoint58k_post
o testreport:
 - always build in dir. "build" (if not there, mkdir build instead of building 
   & running in input)
 - run in dir run (if it exists), in build otherwise.
 - call prepare_run (if input/prepare_run exists)
 - run multi-threaded test (with new option: "-mth") if file input/eedata.mth exists.
o pkg/exf modifications to interpolation and rotation routines for more
   reasonable treatment of North Pole singularity: for tracers North Pole
   value is set to northernmost zonal-mean value, for zonal velocity it is
   set to zero, and for meridional velocity it is set to northernmost value.
o pkg/exf/exf_check_range.F
 - add tile index to diagnostics and move stop statement to the very 
   end of the routine. 
o pkg/diagnostics: (diagnostics_main_init.F)
  define title of isomorphic variables according to the current config.
o pkg/thsice with pkg/seaice dynamics:
- fix domain of computation (interior only, required for exf) and do exchanges
- seaice-dynamics forcing: add atmospheric and seaice loading to SSH gradient
o towards a standard way of dealing with multi-threading in MONITOR
  and ${PKG}_MONITOR (all except ptracers_monitor) subroutines.
o Pass variable viscosities (vertical and horizontal, e.g., KPP or Leith) 
   to W momentum equation in nonhydrostatic and quasihydrostatic runs.  
o make exf_monitor & seaice_monitor independant of the main (dynamics) monitor.
o pkg/seaice: fix SEAICEuseEVPpickup parameter (put it in a commom block)
o generic_advdiff: DST advection S/R : use local copy of velocity to compute CFL
   (problems ? with gradient check in bottom_ctrl_5x5 adjoint test)
o tracer advection: 
 - clean-up and simplify calc_common_factors.F
 - make a local copy of velocity and pass it (as u,v,r_Trans) to DST tracer 
   advection subroutine (but still not used within DST advection S/R)
o rename pkg aim_ocn_coupler to atm_ocn_coupler (later on, will be used without aim)

checkpoint58j_post
o new driver S/R: LOAD_FIELDS_DRIVER to load external forcing fields
  from file (collects calls previously in FORWARD_STEP)
o move call to SEAICE_MODEL from FORWARD_STEP to DO_OCEANIC_PHYS
o adjoint store dir. adjusted accordingly
o genmake2
  replace target "ad_taf" by $(EXE_AD) ; add $(EXE_AD) to the make CLEAN list.

checkpoint58i_post
o pkg/seaice: add parameter that allows to scale/turn off effect of seaice 
  on wind stress (SEAICEstressFactor defaults to 1.)
o Total number of Timers is finite (<=40): comment out 2 non-essential one
  in the_main_loop.F to avoid Pb (e.g., when running fizhi test)
o vector_invariant: fix highOrderVorticity(=4.th.Order) advection 
  on CS-grid: no longer loosing mass.
o exf & curvilinear-grid: no longer modify longitude xC & xG.
o pkg/ggl90: fix sloppy output and fix a bug
o pkg/seaice: added SEAICEuseEVPpickup parameter
  - Set to false in order to start EVP solver with
    non-EVP pickup files when using SEAICEuseEVP
  - fix sign error in diffusion in seaice_calc_rhs

checkpoint58h_post
* Modifications for bottom topography control
  o replace hFacC by _hFacC at various places
  o replace ALLOW_HFACC_CONTROL by ALLOW_DEPTH_CONTROL
  o add non-self-adjoint cg2d_nsa
  o update autodiff support routines
  o re-initialise hfac after ctrl_depth_ini
  o works for 5x5 box, doesnt work for global_ocean.90x40x15
* Adding verification for 5x5 box (4-layer) bottom topography control

checkpoint58g_post
o pkg/diagnostics: implement "periodic averaging diagnostics" (e.g.,
   used for mean seasonal cycle, mean diurnal cycle); add an example
   in verification/global_ocean.cs32x15/input.thsice/data.diagnostics
o pkg/ggl90: 
  - add parameter (minimum surface kinetic energy)
  - fix bug (avoiding division by zero)
o couple pkg/thsice to pkg/seaice:
  - modify advection in seaice to accomodate new scalar fields to be advected
  - only muliDimAdection scheme work with seaice/thsice
  - mapping of thsice-variables to seaice-variables, back and forth
  - does not break the verification experiments, but does not give the
    desired results either
o pkg/seaice
  - make (default) second order advection a bit less confusing?

checkpoint58f_post
o couple pkg/thsice and pkg/exf (as a preparation for coupling pkg/thsice 
  to pkg/seaice): 
  - new routines thsice_map_exf and thsice_get_exf provide the interface
  - add an additional formal parameter to thsice_solve4temp 
o pkg/exf:
  - add new fields wspeed, snowprecip (to be able to couple to thsice)
  - correct Stefan-Boltzmann constant
  - new parameter for longwave surface emittance
  - separate some stuff from exf_bulkformulae into new routines  
    exf_radiation, exf_wind
  - add new parameters and constants: longwave emissivity for ocean, ice 
    and snow, evaporation parameters over ice
  - decouple wind/stress computation from ALLOW_BULKFORMULA: always compute
    either wind from stress or stress from wind
o pkg/thSIce:
- split thsice_step_fwd.F in 2 S/R: thsice_step_temp.F & thsice_step_fwd.F
- put i,j loops inside S/R: THSICE_ALBEDO, THSICE_SOLVE4TEMP, THSICE_EXTEND
   and THSICE_CALC_THICKN
- for now, call to THSICE_GET_BULKF remains inside i,j loops.
- add CPP option: ALLOW_DBUG_THSICE and header file THSICE_DEBUG.h
  to make debugging easier.
- affects results (@ truncation level) of global_ocean.cs32x15.thsice: update output
o pkg/bulk_force: 
  - clean-up comments and parameters ; 
  - add new Bulk-Formulae from Large and Yeager, 2004, NCAR/TN-460+STR ;
o fix bug in aim+thsice albedo: snow & ice thickness arguments were switched;
  generate new output for test-experiment: aim.5l_cs.thSI
o results_ad : rename "output.txt_adm" to "output_adm.txt" and change
  testreport accordingly

checkpoint58e_post
o SEAICE_CGRID adjoint done
o R_STAR adjoint implemented.
  * Seems to just work (based on global_ocean.90x40x15/code_ad_nlfs/ )
  * need to sort out init. of h0facc, etc.
o Make pkg/profile fully independent of ecco,cost, etc. stuff
  to be able to use it in pure forward.

checkpoint58d_post
o upgrade simple test-experiment to tutorial example:
 step.1: duplicate the experiment and (step.2) will remove the old copy.
  tutorial_barotropic_gyre      <- copy of exp0     (R1:barotropic_gyre_in_a_box)
  tutorial_baroclinic_gyre      <- copy of exp1     (R1:baroclinic_gyre_on_a_sphere)
  tutorial_global_oce_latlon    <- empty for now    (R1:global_ocean_circulation)
  tutorial_global_oce_biogeo    <- copy of dic_example
  tutorial_deep_convection      <- almost like exp5 (R1:nonhydrostatic_deep_convection)
  tutorial_plume_on_slope       <- copy of plume_on_slope
  tutorial_tracer_adjsens       <- copy of carbon   (R1:tracer_adjoint_sensitivity)
  tutorial_global_oce_optim     <- empty for now (David ?)
  tutorial_global_oce_in_p      <- copy of global_ocean_pressure
 some tutorials (R1) were already checked-in under tutorial_examples in release1_branch
o correct a sign problem in cost_scat.F
o obcs and ptracers: fix boundary conditions for advections schemes 
  with larger stencil 
o thsice adjoint: start
o mom_vecinv: add ISOTROPIC_COS_SCALING flags to mom_vi_hdissip for 
  completeness
o mom_fluxform: fixing the mutual use of ISOTROPIC_COS_SCALING 
  and COSINEMETH_III, add comments in default CPP_OPTIONS.h
o ptracers adjoint:
  * avoid extensive recomputatations
  * fix missing re-init. of gptr (missed by TAF)
o obcs: add a flag (OBCSprintDiags, defaults is true) that allows 
  me to turn off the excessive output to STDOUT that this package produces
o move NH metric terms & 3.D Coriolis S/R to pkg/mom_common
  and add those terms in Vector-Invariant formulation.
o in ctrl pkg, if ALLOW_CAL, use monthly mean controls 
  if the control period (xx_hfluxperiod etc) is 0
o in profiles pkg, clean routines and fix details
o in ecco pkg, reading ssh data: 
  fix problem in case the model does not start at iter0=0
o fix mnc-pickup/restart for ptracers
o new package prifiles:
  code to compute profile-based cost by Gael Forget
  (modifs in ecco, ctrl, autodiff)
o Benign bug fix in initialization (spotted by M. Mazloff) of
  ctrl_set_globfld_xz.F ctrl_set_globfld_yz.F

checkpoint58c_post
o adjoint: finish NLFS adjoint and provide reference output in
  verification/global_ocean.90x40x15/results_ad_nlfs
o seaice: add an EVP solver following Hunke and Dukowicz (1997) and the 
  documentation of CICE. Turn on by defining SEAICE_ALLOW_EVP in
  SEAICE_OPTIONS.h and SEAICEuseEVP=.true. in data.seaice. Works only 
  with SEAICE_CGRID defined.
o move calendarDumps from "data" to "data.cal" and clean-up the code
  with a simple call to pkg/cal S/R: CAL_TIME2WRITE
o add useEXF & useCAL flags (for now, set in hard-coded way)
o add S/R to compute NH-metrics terms & Coriolis f' in vertical momentum
  (were missing in NH mode, and wrong in quasihydrostatic mode).
  waiting for Chris updated version of calc_gw to add those CALLs.
o fix bug in quasihydrostatic S/R ;
  add a test for this option: global_ocean.90x40x15.qshyd
o new S/R "SET_PARMS": set parameters that might depend on the use of some pkgs.
  (called from INITIALISE_FIXED, after INI_PARMS & PACKAGES_READPARAMS)
o add on/off flag useOffLine for package OFFLINE
o seaice: 
  - modify advection so that it works also on the C-grid
  - extend loop ranges in seaice_lsr and seaice_dynsolver; fixes 
    problem in multi-tile runs with C-grid
  - add flags for clipping ice velocities and/or masking solver forcing
  - fix drag (ocean on ice) formulation and a bug that caused noise in the
    C-grid solver
  - added a few comments to seaice_diffusion.F
  - separate C-grid and B-grid versions more cleanly (UVM and seaiceMaskU/V
    are now exclusive)
  - add a new ocean-ice stress coupling method (Hibler and Bryan, 1987) which 
    required re-ordering the code a little:
   + make DAIRN global variable (defined in SEAICE)
   + move computation of the viscosities eta and zeta into a new separate
     routine (because I need to recompute them in seaice_ocean_stress.F)

checkpoint58b_post
o AIM+thSIce: fix sign of Short-Wave through the Ice ; 
  update output.txt of exp. aim.5l_cs.thSI
o various mnc cleanups and improvements:
  + shrink lookup tables by factor of ~4
  + better error reporting when running out of lookup space
  + able to handle longer path/file names (up to 500 chars)
o adjoint:
  - Another overhaul of store dirs. for NLFS to eliminate  "hidden" recomputations.
  - TBD: "hidden" mom_vecinv recomp. in dynamics
o change forcing_In_AB to affects both T,S forcing and Momentum forcing
 (allow to differentiate between forcing components using new integer flags:
  momForcingOutAB=1/0 & tracForcingOutAB=1/0)
 and add new flag to put Dissipation tendency out of Adams-Bashforth.
o ecco
  - enable trend removal from SSH anomaly obs.
o adjoint
  - a fix for PmEpR when #undef EXACT_CONSERV
  - fix of "hidden" recomp. in thermodynamics (no TAF warnings)
  - try to fix "hidden" recomp. in forward_step for NLFS
    (NLFS seems broken sometimes after I checked it in)
o seaice: 
 - add c-grid version of the dynamic solver:
   + three new routines that are the c-grid substitute lsr, dynsolver
     and ostres
   + put a few fields that were local to dynsolver into global common
     blocks, so that I can move the computation of stresses etc into
     seaice_lsr (saves coding but may break the adjoint).
 - replace more hardwired parameters by runtime parameters
 - add ice masks that mask the rhs of the implicit solvers where there
   is no ice (commented out in seaice_dynsolver, because i am not sure
   if this works properly), eventually this should replace the clipping
   of ice velocities in seaice_dynsolver to +/-40cm/s.
o remove the BUILD_INFO.h include from CPP_EEOPTIONS.h and explicitly 
  include it only where its needed
o move balancing of fluxes before the call of external_forcing_surf
o seaice:
  - correct units of turning angles (now they are really in degrees)
  - move computation of GWATX/Y out of main routine into dynsolver
  - initialize GWATX/Y in seaice_init
o Apply mask on Fresh-Water flux (needed for SSH forcing).
  update output.txt of exp. global_ocean_ebm & cpl_aim+ocn (affects cg2d residual) 
o seaice: add runtime flags for turning angles (default to zero)
o Adding runtime parameter to exf/, ctrl/, to remove on-the-fly global mean 
  and trend from exf forcing and ctrl control adjustments
o fix variable aliasing in gad_calc_rhs that cannot be handled by TAF
  (since checkpoint57x_post)
o change the default rotation period to 86164.s = the Earth rotation
o 1rst implementation of Implicit IGW using the 3-D solver (use3Dsolver=T)
  and based on a reference stratification. Tested within hs94.cs-32x32x5.
o seaice advection: add code for choosing between the default (2nd order
  central differences) and multiDim advection schemes provided by
  pkg/generic_advdiff
o seaice:
  - removed all references to SEAICE_GRID.h fields from 
    dynsolver, advect, diffus, lsr, without changing the results of lab_sea
    (cubed-sphere configuration will change a little)
  - grid computations in seaice_init are obsolete now.
  - cleaned up code a little so that is easier to read (hopefully).
  - added new (better?) discretizations of default advection and diffusion
    (turn on with SEAICEuseFluxForm)
  - replace 1 in 3d global fields by kSurface in growth.F
  
checkpoint58a_post
o seaice:
  - bug fix in advect.F
o shelfice: 
  - separate shelfice load anomaly from pload (breaks with time 
    dependent forcing), => introduce constant field shelficeLoadAnomaly.
    Its default is 0., but it may be computed more cleverly from (unknown)
    t- and s-profiles (tRef, sRef) and actual EOS. For now this has to be
    done offline. A good approximation of the pressure load anomaly is
    necessary to avoid large initial adjustment processes underneath 
    deep-reaching shelfice.
  - small fix in ISOMIP shelfice_thermodynamics
  - add more sophisticated thermodynamics of Hellmer (1989), this is 
    now the default
  - give a few constants more intuitive names
o add code to balance EmPmP and Qnet at the end of do_ocean_physics. Useful
  if bulk formulae are used in long integration (especially EmPmR). Turn
  on with balanceEmPmR = .true. or balanceQnet = .true. in data, PARM01
  if balancePrintMean, the imbalance that is substracted is printed to
  STDOUT.
o fix bug (typo) in obcs_apply_eta.F
o add a new package shelfice which enables us to model the circulation
  underneath shelf-ice with draughts of hundreds of meters.
 - works
 - to do: + include improved thermodynamics
          + check whether kSurfC (from model/inc/SURFACE.h) can be used
            instead of new field kTopC
          + can we use topoFile, Ro_surf and existing code in ini_depth.F 
            instead of new field R_shelfIce and new code in ini_depth.F
            and ini_mask_etc.F?
          + adjust vertical mixing schemes?
o seaice pkg: 
 - add a cpp-flag to include a simple formula for a salinity dependent 
   freezing point of sea water at the surface
 - change the contents of SEAICE_TEST_ICE_STRESS_1 so that zonal and
   meridional stresses are now different (and hopefully correct)
o AIM pkg: change threshold on large-scale condensation to conserve Heat.
   update results of aim.5l_LatLon test ; fix title & units of AIM diagnostics
   and  change 3 diagnostics names (OSR,OSRCLR,KM -> TSR,TSRCLR,DRAG)
o pkg/diagnostics: add options and parameters for regional-statistics 
   diagnostics ; define regions by reading a region-mask from a file 
   (might add other options later)
o pkg/bulk_force:
 - add option and parameters to use AIM surface-flux formulae.
 - Change loading part: S/R BULKF_FIELDS_LOAD only take care of bulkf_fields ;
   others forcing fields (defined in PARM05, parameter file "data") are loaded 
   from S/R EXTERNAL_FIELDS_LOAD, as usually (with useBulkforce = T or F).
 - initialise all bulkf_fields in bulkf_init.F ; do in-lining of exf_bulkcdn.F 
 - use the right EXCH call for uwind,vwind (to work on CS-grid).
 - re-arrange header files (move parameters from BULKF.h to BULKF_PARAMS.h)
   and parameters (note: calcWindStress replaces .NOT.readwindstress).
 - cleaner interface with pkg/thSIce (new S/R THSICE_GET_PRECIP).

checkpoint58
o add "--embed-source" option to genmake2 which, when the supporting 
  tools can be compiled (as determined by genmake2) will turn on the 
  embed_files package which then embeds the entire MITgcm source code 
  (*.[fFhc] + Makefile) used for the build within the executable
  - requested by CNH but off by default
  - adds a paltry <9MB to the mitgcmuv executable in most cases
  - only writes the output when useEMBEDSRC in eedata is true
o clean up 3-dim. relaxation codes:
  * Fix I/O inconsistency in pkg/rbcs: replace precFloat32 by readBinaryPrec
  * Remove 3-dim. relaxation code from pkg/exf (now use only pkg/rbcs)
  * Thanks to Tom Haine for testing!

checkpoint57z_post
o make CG3D solver compatible with Free-surface at k > 1 (p-coordinate):
  affects output (@ truncation level) of exp. plume_on_slope ; updated.
o fix the pickup behavior for obcs in combination with ptracers
o fix a bug in ptracers_external_fields_load
o no AB-2 at the first iteration for Gw (consistent with Gu,Gv,Gt,Gs ...)
  affects results of NH experiments (but all our NH tests have Gw[it=1]==0 !!)
o transfered surface NH pressure to eta field (if exactConserv).
o gmredi: fix bugs in slope tapering ldd97 (depthZ had the wrong sign)
     and update lab_sea output.txt file.
o completing 3-dim. relaxation code: additional term
     1/tau*( theta(i,j,k) - thetaStar(i,j,k) )
  in S/R EXTERNAL_FORCING_T (file external_forcing.F)
  * At compile time, in "EXF_OPTIONS.h" set
      #define  ALLOW_CLIMTEMP_RELAXATION
      #define  ALLOW_CLIMSALT_RELAXATION
  * At runtime in "data", under &PARM03 set (e.g., units in seconds)
      tauThetaClimRelax3Dim = 15552000.0,
      tauSaltClimRelax3Dim  = 15552000.0,
  * 3 cases:
      1) Use a constant-in-time 3-dim. field
      2) Provide 12 3-dim. fields corresponding to Jan., ... , Dec.
      3) Real-time relax. to time-evolving prescribed field
o Adding Laplacian-type smoothness constraint on 
  initial and boundary (forcing) controls (ic, bc)
  * enable at compile-time via 
    ALLOW_SMOOTH_IC_COST_CONTRIBUTION, ALLOW_SMOOTH_BC_COST_CONTRIBUTION
  * enable at run-time via mult_smooth_ic = 1, mult_smooth_bc = 1
  * Absolute scale somewhat unclear so far
  * no area weighting was included since no other cost term does so far

checkpoint57y_post
First step for a NLFS adjoint
o initially suppress rStar (new flag DISABLE_RSTAR_CODE)
o new init. routines for calc_r_star, calc_surf_dr
o still need to deal with ini_masks_etc
o testreport seemed happy
checkpoint57y_pre

o obcs: always reset wVel & eta (to zero or prescribe it) at the OBs.
o add new package rbcs (for relaxing ptracers at boundaries/depth/surface etc)
o add new offset feature to offline pkg (plus minor cleanup)
o cfc fixes for final year of integration
o clean up GCHEM_OPTIONS.h/DIC_OPTIONS.h (all options should
  be in GCHEM_OPTIONS).

checkpoint57x_post
o fix testreport Pb in multiple test experiment.
o cleanup our namelist syntax in verification:
  - make it more F95 standards compliant (some work still needed)
  - allows the vast majority of our tests to work with gfortran
o Non-Hydrostatic:
 - put all NH variables (formerly in DYNVARS.h & GW.h) in NH_VARS.h
 - fix exchange calls for CS-grid using the new EXCH_S3D_RL.
o Allow to apply AB on T,S rather than on AB(gT,gS):
 - implemented within #ifdef ALLOW_ADAMSBASHFORTH_3
 - use the same arrays (gtNm,gsNm) to hold tracer field at previous
   time-steps (if AB(T,S)) and tendencies (if AB(gT,gS)).
 - need a "clever" read_pickup to restart from the other AB formulation
o move local commom bloc /GlobalLo/ (used for singleCpuIO) in EESUPPORT.h 
o remove some unused variables (reduces number of compiler warnings)
o adjoint
  * Disable useVariableViscosity for adjoint for time being
    (there are a number of extensive recomputations)
  * Initialize certain variables needed for adjoint

checkpoint57w_post
o pkg/mdsio: use MAX_LEN_FNAM (instead of hard coded 80) for file-names
             fix the singleCpuIO RS version of MDSWRITEFIELD
   and add a WARNING if using globalFiles=T with multi-processors.
o write grid-file(s) in only one format (MDS or MNC): default=MNC (if
  using MNC); can force MDS output by setting writegrid_mnc=F in data.mnc
o tracer advection scheme:
  add DST-2 (=Lax-Wendroff) & 1rst order upwind schemes (the way to get 
   those 2 schemes before, changing GAD_FLUX_LIMITER.h + to recompile, 
   was not very convenient).
  add implicit version for DST-3 & DST3_Flux_Limit vertical advection;  
   (further tests needed for the implicit DST & Flux-Limiter schemes).
o PTRACERS: added namelist parameter PTRACERS_ref in analogy to tRef
  and sRef for convenience, handy, when you want to initialize
  ptracers in a large domain with a constant non-zero value. Also,
  untangle ptracers_init.F a little.

checkpoint57v_post
o change dome exp. to use variable viscosity in side-drag terms.
o remove all the files from the cfc_offline test since they are now
  incorporated into tutorial_cfc_offline which has been producing
  identical results for a few days of testing
o add new parameter: sideDragFactor to enable half-slip-side BC
  and change side-drag S/R to use viscosity from mom_calc_visc
  (can switch back by setting sideDragFactor=0.); affects results at 
  truncation level; regenerate output for exp.: global_ocean.cs32x10(x3), 
   global_ocean_ebm, global_ocean_pressure, matrix_example & MLAdjust(x5).
o vorticity & strain are now computed without masking, to account for 
  no-slip-side BC in variable viscosity calculation ; mask is applied
  anyway later on, before computing advection/coriolis terms.
o modify exp4 to test new obcs support for reading from external files
  and for passive tracers
o fix behavior of ptracers_monitor when monitor output is written to a 
  netcdf-file; still not independent of monitor.F (writes in the same
  file).
o change default value of tRef (put a uniform, meaningful value for ocean 
  & atmos) and initialize sRef (was missing, as Martin mentioned).
o Redefine viscC?Leith*.  Change the coefficients of Leith viscosity 
  to be proportional to enstrophy dissipation length.  Thus,
   viscC?leith?_new=pi*(viscC?leith?_old)^(1/3)
  This is now consistent with Smagorinsky and with the manual.

checkpoint57u_post
o OBCS and PTRACERS: add open boundary support for passive tracers
  - either use homogenous (pseudo) v.Neumann conditions or prescribe 
    OB-values from file; this is not different from the way theta and salinity
    are treated
  - however, Orlanski-radiation conditions are not supported, and the model
    will stop if you use pTracers and Orlanski at the same time. 
  - beefed up the rountine obcs_external_fields_load: now only those open
    boundary values are overwritten with values from files for which there 
    are really files, otherwise the OB-fields remain untouched. This makes
    it possible to use different OBs at different ends of the domain (as 
    with EXF)
o reduce number of exch calls in shap_filt (s2). 
o CS-grid: fix divergence contribution to Leith viscosity. Affects (@ 
  truncation level) 4/5 MLAdjust test results (11&12 digits match).

checkpoint57t_post
o test biharmonic viscosity + no-slip with exp: global_ocean.cs32x15.viscA4
o finish adding brackets (coriolis S/R, vecinv) in multi-terms sum to get
  same truncation, independent of the face number: affects affects several
  test. exp.: Update global_ocean.cs32x15 (+.thsice) & MLAdjust (all 5).
o fix bug in mom_v_sidedrag (biharmonic viscosity was counted 2 times);
  note that biharmonic viscosity + no-slip was not tested in any experiment.
o fix bug in non-linear free-surf side-drag ; generate new output for
  global_ocean.cs32x15(+.thsice) & global_ocean_pressure.
o make mnc honor the writeBinaryPrec flag for most kinds of output
o eesupp: split EEPARAMS into EESIZE/EEPARAMS and add a vector global sum
o minor change in averaging W (mom_vi_?_vertshear.F) that affects truncation
  error; update output from global_ocean.cs32x15(+.thsice) & MLAdjust (all 5).
o add brackets in multi-terms sum to get same truncation, independent of
  the face number (manage to get exactly same value of gU,gV at the cs-edge)
  affects several test. exp. Update global_ocean.cs32x15 (+.thsice).
o Clean, new version of mom_calc_visc.  Adds a new feature, viscAhRemax
  and viscA4Remax, which allow one to limit the minimum viscosity by specifying
  a maximum grid-scale Reynolds number.  Also, changes all length calculations
  in the case of grid anisotropy to geometric mean of dx**2 and dy**2.
  Suggested values of viscosity parameters found in mom_calc_visc. 
  Many new viscosity diagnostics available.

checkpoint57s_post
o Add clearing-house for viscosity calculations, mom_calc_visc and 
  correct numerous bugs in LeithD and Smagorinsky discretizations.  
  mom_calc_visc now allows for Smagorinsky, Leith and LeithD to be 
  used simultaneously, and to be used in mom_vecinv and mom_fluxform. 
  Mom_vecinv can be used with standard viscous calculation (mom_vi_hdissip.F)
  and with Strain-Tension viscous term calculation (mom_hdissip.F).  
  The Strain-Tension form is now called with useStrainTensonVisc=.true.
  ViscAhStrain and viscAhTension are now retired.
o diagnostics "VISCAHD" & "VISCA4D" replace "VISCAH" & "VISCA4".
o In response to JMC's bug report, genmake2 now ignores any soft-links
  that it finds in the *current* directory when searching for files.
  Soft-links found in any other source directories will still work as
  they did before.
o add HAVE_SETRLSTK define and useSETRLSTK flag (eedata) which calls 
  a C routine to unlimit the stack size
o mnc-ify pkg/aim snapshot vars
o mnc-ify pkg/land as requested by Daniel
o various changes to mnc including:
  - all files use the new "BASENAME[[.ITER].{t|f}NUM].nc" format
  - output can now be grouped so that all files within a group 
      change the ITER portion of their names in lock-step together
  - can now read ("global") PER-FACE (in addition to PER-TILE) files
      and works with both EXCH1 and EXCH2 (but needs more testing)
  - writing works for all verification test cases w/ g77 on Linux

checkpoint57r_post
o make MNC variable initialization happen earlier
o add diagnostics for (almost) each term of the momentum Eq.
o remove SST,SSS,UVEL_k2,VVEL_k2 diagnostics.
o move pkg timeave out of pkg-groups "oceanic" & "atmospheric" (pkg/pkg_groups)
o remove MINIMAL_TAVE_OUTPUT option ; 
  add "dumpInitAndLast" to replace "nodumps" (and MINIMAL_TAVE_OUTPUT).
o move some basic S/R (used elsewhere in the code) from pkg/mdsio to eesupp/src
  allows to compile without pkg/mdsio (& test successfully hs94.1x64x5)
o add MNC output for adjoint of EXF (adexf), SEAICE (adseaice)
o add time-dependent SST, SSS control
o cost terms in ecco/ modularized (new cost_generic.F)
o cost_averages routines are modularized (new cost_averagesgeneric.F)
o new infrastructure for seaice model vs. obs misfits in seaice/
  * driver from the_main_loop.F is seaice_cost_driver.F
  * first term is AREA vs. SMR observation misfit (ALLOW_SEAICE_COST_SMR_AREA)
  * gradient check in Exp. 6a of natl_box_adjoint/
o natl_box_adjoint input_seaice for Lab. Sea now available online via wget
  (see README file)

checkpoint57q_post
o fix initialisation Pb in calc_gw (get NANs in exp5 with g77)
o fix annoying months-old bug in mnc/mdsio output for seaice pkg
  - bug was reported by Jean-Michel and Ian Fenty
o fix initialization Pb in AIM-Ocean coupled model (aim_sice2aim.F)
  update exp. cpl_aim+ocn output. 
o Implement 4-level checkpointing: AUTODIFF_4_LEVEL_CHECKPOINT
  Needed for high-res. runs with large global files 
  to be able to limit tapelev size
o Changed some tests for adjoint:
  * carbon/ now tests AUTODIFF_2_LEVEL_CHECKPOINT
  * natl_box_adjoint/code_bulk/ tests AUTODIFF_4_LEVEL_CHECKPOINT
  * global_ocean.90x40x15/ back to default 3-level checkpointing
o Modifications to enable scripted COMMON to MODULE conversion
  * verification/OpenAD/code/ has necessary scripts and description;
  * converts, compiles and runs successfully;

checkpoint57p_post
o reading of delXfile & delYfile moved from ini_parms.F to ini_grid.F
o move ${PKG}_MNC_INIT from ${PKG}_READ_PARAMS to ${PKG}_INIT_FIXED
  (already the case for some pkgs, including recent MNC_init, e.g. thsice)
o call CALC_GW from DYNAMICS (instead of from FORWARD_STEP)
o Dissipation & phiHyd gradient are always added to gU,gV in timestep.F
  (was already the case for dissipation with mom_vecinv,
   and also the case for grad.PhiHyd when staggered-timeStep)
  This will allow to put dissipation out-off the AB time-stepping.
 Unfortunately, affects truncation error. Update output of exp. that "fails"
  (cg2d matching number) and leave the others for later: front_relax(10),
  global_ocean_pressure(10),ideal_2D_oce(10),internal_wave(9),lab_sea(12),
  matrix_example(7!),natl_box(12),plume_on_slope(11),vermix(12x3,11x2).

checkpoint57o_post
o fix MNC/MDSIO flags in PTRACERS so that (1) it works, and 
  (2) its ready to be documented during the 20050801 DocFest
o MNC-ify the gmredi package -- tested and works w/ and w/o mnc 
  for ideal_2D_oce and lab_sea on linux_ia32_g77
o set to #undef CTRL_SET_OLD_MAXCVARS_30
  in global1x1_tot/code_seaice_adj to access indices 32, 33
  (worth another tag)

checkpoint57n_post
o adding precip control xx_precip 32
o adding swflux control xx_swflux 33
o Replacing 10 forcing penalty cost routines by 1 generic.
o Implementing partitioning in time-mean and variable adjustment
  for atmos. state.
o Time-mean constant error is now read in data.ecco (instead of hard-coded)
o in natl_box_adjoint:
  * updated exp 1 to 10 
    (but does not have time-mean vs. variable split results yet)
o updated global1x1/*_seaice_adj/
  to incorporate latest changes
o enable useSingleCpuIO for mdsio vector routines
  (applies in particular to tapelev I/O)
o removed inefficient K-loop in all active_file*control*.F

checkpoint57m_post
o re-arrange exp. adjustment.cs-32x32x1 (adjust_nlfs.cs-32x32x1 merge into)
  and advect_cs (use EXCH-2 and standard cs-32 grid files).
o pkg/exch2: filling of face-corner halo regions is optional 
  (ifdef W2_FILL_NULL_REGIONS) and is turned off by default.

checkpoint57l_post
 tag before updating tutorials (pre-release-2) 
o add cos & sin of grid-direction orientation angle (curvilinear grid only,
   for output and interpolation of input fields onto model grid)
o fix radius in mom_v_metric_cylinder.F (wrong by dy/2).
   Affects results of exp. rotating_tank ; update output.txt.
o pkg/diagnostics: 2 new S/R to fill a diagnostics using a scaling factor
      and taking the square quantity and/or using a fraction-weight field.
o fix aim_diagnostics_init.F mate numbers.
o add mnc output capability to diagnostics/diagstat and update
  our cvsignore files for the ACSII output generated

checkpoint57k_post
o lab_sea now uses diagnostics package and provides a suite of
  new EXF diagnostics output.

checkpoint57j_post
o exf
  * bug fix in exf_bulkformulae for psimh (spotted by Eliyahu Biton):
    Bracket missing in eqn. for psimh (eqn. 7 of Large & Pond, 1982);
    terms -2*ATAN(x) + pi/2 were added to both stable and unstable case.
  * extended diagnostics output
    - now includes all EXF variables
    - hs, hl moved to common block
    - separate S/R for diagnostics, called after ctrl vector is added
    - name changed for EXFsw -> EXFswnet, EXFlw -> EXFlwnet
    - EXFqnet contains true Qnet (i.e. includes qsw)
  * updated verif. lab_sea, global_with_exf
  * Rearranging hflux (exf_mapfields -> exf_getforcing)
    to ensure that diagnostics sees a true EXFqnet
o add matlab scripts for CS-grid vectors (in utils/cs_grid)
o diagnostics pkg: change pointers so that 1 diagnostic can be used
  several times with different frequencies.
o mnc-ify the thsice package as requested by Daniel Enderton
  - the monitor--MNC output needs work
  - many attributes need to be added (most are currently blank)
o mnc-ify theaim_v23 package as requested by Daniel Enderton
  - many attributes need to be added (most are currently blank)
o remove "groundAtK1" & "rkFac" (replaced by usingPCoords & -rkSign)
o add Sadourny like discretization to the 4th.O vorticity advection scheme
o fix bug in rStar code (calc_r_star.F) when used with topo/bathy. 
  update output.txt from: aim.5l_cs (& .thSI), cpl_aim+ocn,
     fizhi-gridalt-hs and global_ocean.cs32x15 (& .thsice).
o fix few little things to avoid floating error with -ftrapuv (ifort v9)
 (ini_spherical_polar_grid.F, calc_r_star.F, monitor/mon_surfcor.F)

checkpoint57i_post
o Diagnostics package was changed: diagnostic allocation is now deactivated
  by setting an empty file name in the namelist (used to be by setting 0 frequency)
o momentum advection (VI form) options: activate 4th.O vorticity Coriolis ;
  add 1rst Order upwind vertical Shear.
o add a quick fix for A/B checkpointing in OFFLINE mode
o add IGNORE_TIME define and -ignore_time option to genmake2 as an
  end-run around the C/Fortran linking horror in eesup/src/timers.F
o added pkg/runclock: allows user to terminate run based on wall clock
o added non-hydrostatic scaling parameter: nh_am2
o pkg/my82: futile attempt to make results compiler-independent by adding
  some "_d 0", etc. no effect.
o for mnc output, fill the 'T' coordinate var with myTime and create a 
  separate 'iter' variable for iteration count
o pkg/diagnostics: 
  add new capability: output of Global/Regional & per-level statistics ;
  tested against monitor output (including land & thSIce) on various exp.
o make seaice-pkg I/O type flags (MNC/MDS) more standard.

checkpoint57h_done
  tag after changing user customized files (DIAGNOSTICS_SIZE.h, 
  data.diagnostics, data.gchem, data.ptracers) is done.

o pkg/diagnostics: prepare for Global/Regional statistics. 
  add 2nd namelist in data.diagnostics and update DIAGNOSTICS_SIZE.h 
o remove "baseTime" (no used) from arg. list of DIFF_BASE_MULTIPLE
  and rename it: DIFFERENT_MULTIPLE

checkpoint57h_post
o move tIter0 from data.gchem to PTRACERS_Iter0 in data.ptracers
o pkg/diagnostics: change output frequency, now in seconds (instead
  of Nb of iterations). This requires to change data.diagnostics.
checkpoint57h_pre

o in mnc, let the user create the output dir if both mnc_outdir_date
  and mnc_outdir_num are false
o add fflags() to pkg/diagnostics which allows one to specify, on a
  per-file basis, the file precision [default behavior is unchanged]
o added diagnostics to pkg/kpp, including computation of mixed layer
  depth based on a temperature/density criterion
o updated verification/natl_box to test the new pkg/kpp diagnostics
o bugs fixed (with useAbsVorticity=T & with useJamartMomAdv=T)
o test AB-3 code with 4th.Order advection scheme (advect_xy/input.ab3_c4)
o fix mnc flags in pkg/seaice so that they are "owned" by seaice,
  not mnc -- this mistake was found by JMC and is now corrected

checkpoint57g_post
o add Adams-Bashforth 3rd Order time stepping:
  - default remains AB-2 (#undef ALLOW_ADAMSBASHFORTH_3)
  - not yet implemented with NH, CD_Scheme, pTracers, MNC_pickup ...
checkpoint57g_pre

o make lambda[Theta,Salt]ClimRelax spatially varying
  (default remains spatially uniform constant based on tau)
o added new control variables
  * init. uVel, vVel, etanN
  * lambda[Theta,Salt]ClimRelax
o separate masks used for ctrl_pack/unpack 'from write_grid' output
  (suggested by G. Forget)

checkpoint57f_post
o add parameter "baseTime" = model base time = time at iteration zero
  new function DIFF_BASE_MULTIPLE (replace DIFFERENT_MULTIPLE) to 
  account for baseTime shift
o move Coriolis arrays from PARAMS.h to GRID.h
checkpoint57f_pre

o mnc-ifying the seaice package
o introduced an alternative length scale calculation for use in the limiting
  maximum viscosity (off by default, see mom_vi_hdissip.F for details)
o S/R ptracers_calc_diff: argument list bug for CALL KPP_CALC_DIFF_S
o added modified Leith scheme with viscosity proportional to grad(Hdiv) 
  as well as grad(vort3).  Made it compatible with both approximate form
  for the cubed sphere and full form of these gradients.  Added flag
  useFullLeith to select between approximate and full form.  
o add "d0" in getcon.F to reduce differences between compilers/platforms
  update output.txt of exp. fizhi-gridalt-hs
o change port_rand funtion to allow to set the seed.
o fix obscure MNC bug involving conversion between reals and integers
  - it caused no problems with certain (eg. gcc, ifc) compilers but the 
    new version is now more standards-compliant
o adjoint-related modifications
  * gad_dst3_adv_?: to be able to use advscheme=30 in adjoint
  * gad_calc_rhs: fool adjoint, revert to advscheme=30 in reverse when using 33
  * mom_vi_hdissip: to be able to use Leith scheme in adjoint

checkpoint57e_post
o Adding eddy stress controls a la Ferreira et al.
checkpoint57e_pre (actually was tagged: eckpoint57e_pre)

o fizhi pkg: fix AtoC and CtoA when called with same input & output array
  update output.txt of exp. fizhi-gridalt-hs
o add more "Z" dimensions and associated coordinate vars to MNC
o pkg/exf: added twoDigitYear capability for option useExfYearlyFields
o parameter calendarDumps: when set, approximate months (30-31 days) and years
  (360-372 days) for parameters chkPtFreq, pChkPtFreq, taveFreq, SEAICE_taveFreq,
  KPP_taveFreq, and freq in pkg/diagnostics are converted to exact calendar
  months and years.  Requires pkg/cal.
o diagnostics: add pickup functionality
  - off by default for backwards compatibility
  - current version only uses MDSIO -- MNC will be added
o allow to use pkg diagnostics for LAND pkg output & Shapiro Tendencies.
o pkg/shap_filt: fix for multi-tiles per face (CS-grid with EXCH2)

checkpoint57d_post
o pkg/thsice used in the ocean: fix tile Pb related to sIceLoad forcing
o modify verification/ideal_2D_oce so that it tests the creation of mnc 
  output from the diagnostics package
o temporary fix in EXCH2_UV: add a 3rd call to fix the 24.tiles CS-grid set-up
o make genmake2 more portable by using ".$FS" instead of ".f" for more
  of the test compilations (eg. IBM xlf on Mac OSX w/HFS filesys)
o add coordinate variables to the MNC output from the diagnostics package
o change MNC-flags default value: true when useMNC=TRUE
o add a "readgrid_mnc" flag to MNC and give model/src/ini_curvilinear_grid.F
  the ability (off by default) to read the grid information using MNC 
o lab_sea: use LSR_ERROR=1.E-12 for testing ; update output.txt
o diagnostics: fix a bug (sub-set of levels); keep full precision when averaging
o do snap-shot diagnostics at the middle of the time-interval (instead of 
  at the end).
o update exp. aim.5l_cs (use default LAND_OPTIONS.h file) and add
  new test for AIM with thSIce + slab-ocean
o cpl_aim+ocn test: update output (optfile & default GMREDI_OPTIONS.h)
o move state variable diagnostics to the beginning of the time step ;
  (note: still needs some work specially for snap-shot diagnostics)
  duplicate & replace UVELVVEL diagnostics with UV_VEL_C & UV_VEL_Z

checkpoint57c_post
o Change testing option (-ieee) to get closer agreement between g77 & ifort
o generate new output.txt files on faulks with g77 & the new -ieee option
checkpoint57c_pre

o add "_d 0" in freeze ; change some "FLOAT" to "DFLOAT" and went back (TAF);
  update output.txt of exp. global_ocean.90x40x15
o fix in ini_eos.F (one "_d 0" was missing): now g77 & ifc give much closer 
  results; update global_ocean_pressure & global_ocean.cs32x15 output.txt
o add saltFlux(+File) forcing capability with periodicExternalForcing
o allow to use pkg diagnostics for GM-Redi & ThSIce output
o diagnostics_fill: fill in up to sNx+1 or sNy+1 (if U,V or Z pt) for mnc.
o improvements for the MNC output from DIAGNOSTICS:
  - correct handling of the unlimitied dimension
  - all dims now have associated coordinate variables
  - variables located at U, V, and Corner ("Z") points are now written
    with the correct horzontal dimensions (eg. 'Xp1', 'Yp1') so that 
    *all* data points are output
o added seaice_summary.F and removed obsolete ALLOW_SEAICE's from pkg/seaice
o added pkg/seaice/seaice_monitor.F
o mdsio_readfield.F can now read files visible only to master MPI process.
o pkg/seaice: some test code for ice-modified ocean stress
o exf_getffields interpolation defaults to bilinear for all scalar forcing
  fields (remains bicubic for wind velocity and stress).  This avoids, e.g.,
  spurious negative numbers for precipitation and humidity.  Will cause
  some small numerical differences for integrations using pkg/exf/exf_interp.F.
o pkg/ctrl/
  * Add ctrlvec diagnostics in pack/unpack for nondimensional I/O
    May be enabled via doPackDiag
  *  introduce z-scaling of 
     + gradient (doZscalePack) and 
     + control (doZscaleUnpack)
o pkg/mdsio/
  * enable useSingleCpuIO for state estimation (ctrl_pack/unpack) mdsio_gl.F
  * N.B.: leave tiled I/O for tapelev (i.e. mds...vector)

checkpoint57b_post
o simplify options in diagnostics_fill arguments (remove weird combinations)
o fix MNC coordinate variables so that they now contain per-face index
  values (instead of xC,xG,yC,yG values) when run with EXCH2 since, in 
  general, EXCH2 grids are only aligned to a "local" coordinate system
o test diagnostics pkg in dic_example (no output) and ideal_2D_oce (with ouput)
o Implement instantaneous output within pkg diagnostics:
  setting a negative frequency in data.diagnostics produces
 "snap-shot" output (as opposed to time-average if freq > 0)
o move out off EQUIVALENCE all diagnostics that fizhi does not use ;
  NOTE: change ptracer diagnostics name: use 2 characters to work with 
        more than 9 tracers. Add also diagnostics of advect & diffus flux.
o more CF compliance: convert all MNC 'iter' variables to 'T' so that it 
  becomes the coordinate variable for the 'T' dimension
o add CF-style coordinate variables to MNC
  - just a first cut:  numbers are meaningless on the cubesphere and 
    missing along the T axis but otherwise it works!
o add surface flux diagnostics: TAUX, TAUY, TFLUX, TRELAX, TICE, SFLUX, SRELAX
o pkg/thSIce: read initial state from 6 files ; allow monitor to use MNC.
o add diagnostics of advective & diffusive flux for T & S (pTracers coming soon)
  this is based directly on what the model compute, so that the content of
  each diagnostics might be affected by switching options (e.g., implicitDiffusion)
o small changes for diagnostics (gad_biharm_?.F, arguments of S/R impldiff.F)
o clean up build options files for SunOS, in particular 
  - remove -traditional from xmakedepend
  - change -xarch=v9 to -xarch=native for f77
  - restore use of make (not gmake)
  - add CC=gcc if using g77
o changes per discussion of AM, JMC, & EH3 today:
  - move redundant "grid" variables out of "state" -- in preparation of 
    creating proper CF-style coordinate variables and in recognition 
    that any/all grid variables can be easily copied (eg. w/NCO) from 
    the grid files into any of the other NetCDF files
  - *always* output grid variables with MDSIO (this will eventually be 
    changed)
  - output MNC grid file if useMNC is true
o every instance of _END_MASTER() has been found and replaced with 
  _END_MASTER( myThid ) in order to satisfy certain picky Sun 
  preprocessors
o re-arrange diagnostics pkg initialisation:
 - allow each package to extend the available diagnostics list
 - add some checking and fix small problems (multi-threaded, ...)
 - new S/R diagnostics_fill (replace fill_diagnostics):
   look through the short list of active diag. (instead of the long list)
   create function DIAGNOSTICS_IS_ON to tell if a diagnostics is active

checkpoint57a_post
o this set of changes restores TAMC compatibility
  tested for global_ocean.90x40x15 adjoint on trough
  (what a pain)

checkpoint57a_pre
o some modifs in tools/build_options for sunos
o call ctrl_pack for ctrl at end for optimcycle=0

checkpoint57
o add horizontal bi-harmonic viscosity for vertical velocity
  - new parameter viscA4W (defaults to viscA4)
  - affects only non-hydrostatic code
  - to be done: no-slip lateral boundary conditions
o switch back to "sflux = sflux - runoff" in exf_getforcing.F
o implement Implicit Vertical advection for pTracers
o depth convergence accelerator: replace deltaTtracer by dTtracerLev(k)
  (implemented also for implicit vertical diffusion & advection)
o OBCS: extend application of tracer open boundary conditions
  to a strip beyond the boundary of width Olx/Oly
o add call monitor to TAF set of required calls (flow directives)
  and include in natl_box_adjoint
o untangle a few ifdefs related to cost, ctrl, autodiff
  untangel a few ALLOW_ECCO_OPTIMIZATION
o Apply Cooper & Haines representative estimates also at sub-surface (k=Nr)
  (theta2, salt2 in ecco_cost_weights)

checkpoint56c_post
o OBCS as control variables
  - update ctrl_ad_diff.list, obcs_ad_diff.list
  - remove balance of obcs controls from default
  - fix index bug nobcs in ctrl_init
  - fix dummy fields filen in ctrl_pack
  - add dummy weights for obcs
o lsopt: comment out fort.94 output
o optim: 
  - remove unnecessary header files
  - adjusted namelists
  - add xerbla.F to Makefile
o exf: 
  - multiple modifications of exf_check_range
  - unit change in exf_init_runoff from [m/year] to [m/s]
o mdsio:
  - i/o-vector change debugLevel from debLevA to debLevB

checkpoint56b_post
o collect all ptracers output in an new routine (PTRACERS_OUTPUT) that
  is called from DO_THE_MODEL_IO
  - rename PTRACERS_STATV_WRITE to PTRACERS_WRITE_TIMEAVE
  - introduce new parameter PTRACERS_dumpFreq (defaults to dumpFreq)
  - clean up PTRACERS_WRITE_TIMEAVE a little
o add another verification experiment that tests both the cfc-pkg and
  the gchem-pkg with GCHEM_SEPARATE_FORCING undefined, that is with 
  reactive tendencies treated inline with regular timestepping
o testreport previously did a lousy job of comparing small numbers, so
  we (Ed and Martin) changed the  way the cut-off of 1.e-12 is
  implemented in the little c-progam tmp_cmpnum.c which is embedded in
  testreport. 
o ptracers_monitor: bug fix for MPI

checkpoint56a_post
o GCHEM: finish reorganizating the package
  - forward_step calls GCHEM_CALC_TENDENDY, which computes gchemTendency 
    (introduces another 3D-array for each passive tracer, but only if
    GCHEM_SEPARATE_FORCING is undefined. For GCHEM_SEPARATE_FORCING
    gchemTendency is not needed because the timestep is done separately)
  - gchemTendency is added to gPtr in GCHEM_ADD_TENDENCY
  - GCHEM is now---more or less cleanly---separate from PTRACERS
  - to bo done: handling of surfaceForcingPtr that is needed for KPP not
    so clear to me how that should be done in a general way.
o CFC: improve formatting of output in CFC_ATMOS
o PTRACERS:
  - rename GCHEM_MONITOR to PTRACERS_MONITOR and call it from MONITOR, so
    that ALL experiments with ptracers enable can be checked. This makes
    GCHEM_MONITOR obsolete.
  - include a runtime parameter PTRACERS_monitorFreq that defaults to
    monitorFreq
  - set default PTRACERS_write_mdsio to false if PTRACERS_write_mnc is true 
o add PTRACERS (PTR0[1-5]) to testreport output
o exf_check_range:
  * default changed to .TRUE.
  * will check values for niter0 if debLevA, every timestep if debLevB
  * STOP in exf_check_range if 'out of range'
  * range chosen generous to allow for potential extema
  TBD: a version with stricter range
       permitted range would be runtime parameters
o GMredi:
  - fix ldd97 slope limit ; extend valid domain of Psi-Bolus ;
  - change S/R GRAD_SIGMA to be valid in the overlap on CS-grid.
  - change the default GMREDI_OPTIONS.h: compile everything except Visbeck
o GCHEM: 
  - move call to GCHEM_FORCING_SEP, so that it is now called before
    the blocking exchanges to avoid computing halos in GCHEM_FORCING_SEP
  - introduced a useGCHEM runtime flag and applied it everywhere. 
  - renamed PTRACERS_SEPARATE_FORCING to GCHEM_SEPARATE_FORCING;
    this flag is now only visible within GCHEM-pkg routines.
  - moved gchem_forcing_int temporarily into ptracers_forcing, this will
    be replaced by a 3D array that is computed before thermodynamics; for 
    this, the tracer ID iTracer had to be included into the parameter list
    of ptracers_forcing
  - set up forward_step to call gchem_forcing, that will replace 
    gchem_forcing_int in ptracers_forcing
  - cleaning up
o small cleaning of exch2: remove files that are also in eesupp/src

checkpoint56
o AIM: read land-Fraction earlier (from ini-fixed) and monitor land at nIter0
o mnc: cleanup "full" files--fixes out-of-memory problem
o ECCO-GODAE
  * model/, pkg/, code/, input/ now complete w.r.t. ECCO-GODAE production setup
  * fully merged and updated from SIO code
    windstress sign change affects
    - exf_inscal_[u/v]stress
    - sign of xx_tau[u/v] adjustments
    - signs in cost_scat
  * ctrl_get_gen: avoid update of tau[u/v] for first few days
  * natl_box_adjoint updated and compressed
  * 2-level checkpoint switch added
    (tested in EXP. 1 of natl_box_adjoint)
  * new switch doInitXX to avoid init. of xx_... in optimcycle=0
o SVD
  * first complete, non-hacked version for SVD calculations
  * all interfaces clean w.r.t to handling of xx_..., adxx_..., g_xx_...
    performed via direct access files admtlm_vector.it????
    (via ctrl_[un]pack)
  * optimcycle is used for ARPACK iteration counter
    (note: adxx_... is iterated, rather than xx_...; latter is constant!)
  * EV problem ok w.r.t. L2-norm in tangent space; need to check other norms
    and add linear transforms where necessary 
  * controls are initial/final SST, SSS (can be extended; need to check
    ctrl_set_[un]pack_xyz.F according to ctrl_set_[un]pack_xy.F
o mdsio: filename info to both stderr, stdout
o exf: exf_inscal_runoff: separated default conversion [m/year] -> [m/sec]
  from sign change 

checkpoint55j_post
o isolate dissipation tendency (allow to keep it out off AB) in V.I form.
  affects (truncation level) output.txt of global_ocean.cs32x15(&.thsice)
o add consistent build directories and .cvsignore files to verification
o added viscA4GridMin and viscA4GridMax for more control on biharmonic viscosity
o make all subroutines 30 or less characters in length for certain older 
  compilers to work (a thorough search only turns up two routines in 
  pkg/ptracers)
o allow (vecinv only) a different horiz. viscosity for Divergence and Vorticity; 
  affects (truncation level) output.txt of global_ocean.cs32x15(&.thsice)

checkpoint55i_post
o change arrays for total vertical diffusivity (2.D if explicit,
  3.D if implicit) ; each ptracer uses its own background value.
o added mnc/NetCDF output capability to ocn_compon_interf
  - added bits to verification/cpl_aim+ocn so that it can run on 
    ITRDA and other clusters without the mpirun "-wd" option
o fixed wayward endif in mom_fluxform.F that messed up cyclindrical
  configuration 
o give MNC the ability to create additional files rather than 
  exceeding a specified file size limit "MNC_MAX_FILESIZE" 
  - the default is just less than 2GB which is a practical limit 
    on many systems
o Compute the non-local term using either KPP vertical diffusivity (=default) 
   or the total vertical diffusivity (when KPP_ghatUseTotalDiffus=T)

checkpoint55h_post
o add verification test "vermix"
o remove all the *_ioinc flags and replace with the single global
  outputTypesInclusive flag
o allow to set a vertical profile of vertical diffusivity for T & S
o call PACKAGE_BOOT & PACKAGES_READPARMS just after INI_PARMS
o useMNC moved from data.mnc to data.pkg

checkpoint55g_post
o Renaming carbon AD experiments to comply with testreport conventions
o Updating adjoint of Held-Suarez hs94.1x64x5
o Fixing directives for non-ECCO forward_step, after ECCO directives
  have been fixed to avoid recomp. of do_oceanic_phys
  Works well for global_ocean.90x40x15,
  but recomp. issue remains for carbon
o Updating adjoint output for natl_box_adjoint after 
  pkg/ecco has been modified (see taga c55d_post)

checkpoint55f_post
o rename to timeave_init_fixed

checkpoint55e_post
o some delicate re-shuffle of store directives to avoid one
  extra call of do_oceanic_physics
  affects ecco_the_main_loop.F, do_oceanic_physics.F
  checkpoint_lev1_directives.h
o NB: this may break global_ocean adjoint temporarily,
  but it is clear how to fix it. Will do later, need this now.

checkpoint55d_post
o ECCO specific cost function terms (up-to-date with 1x1 runs)
o ecco_cost_weights is modified to 1x1 runs
o modifs to allow observations to be read in as
  single file or yearly files
o enable to read exf forcing fields as either
  single file or yearly files (flag useExfYearlyFields)
checkpoint55d_pre

o switch between 2-level and 3-level checkpointing
o add ability of MNC to write local and "partial" (eg. 2D slices where 
  the full 3D field is never actually stored) arrays to NetCDF files
  with the correct (that is, the complete multi-dimensional) set of 
  array indicies
  - used in mom_vecinv() to write the diagFreq output
  - tested (demonstrated) in verification/aim.5l_cs
o further mnc-ification
  - add verification/lab_sea to the list with mnc setups
  - fix undefined mnc v-names in cd_code
  - add kpp to mnc output (both snapshot and timeave)
o non-hydrostatic code
  - added horizontal viscosity parameter viscAhW for w, that replaces viscAh
    in calc_gw.F
  - defaults to viscAh
  - this is useful, when I want to use viscAh=0 (e.g., only biharmonic
    friction or Leith) in non-hydrostatic mode, as long as there is 
    no biharmonic friction and/or Leigth or equivalent for vertical velocity.
o pkg/cost
  extend simple cost functions to treat time mean quantities
  (T,U,V) via cost_accumulate_state from cost_tile
o multidimAdvection on CS-grid: implement the full 3 pass ; overlap needs to
    be 2 times larger than the minimum size the advection scheme requires.
    now get a perfect conservation of salt in advect_cs test-exp (updated)
o GGL90 (Gaspar's TKE mixed layer)
  - add horizontal diffusion of TKE, requires exchanges in 
    do_fields_blocking_exchanges, horizontal diffusivity is zero by 
    default. In OPA there is no horizontal diffusion of TKE but the 
    mixing coefficients are computed from a horizontal average of TKE of
    6 points or so. I think that diffusion has a little more physical
    justification.
  - clean up ggl90_calc in the hope of reducing memory usage (this hope 
    was in vain)
  - mask tke-variable in ggl90_init
o fix mask Pb in multidimAdvection on CS-grid (still a small Pb with ipass)
o fix biharmonic diffusion on CS-grid.
o more obcs stuff
  - added obcs_external_fields_load as an alternative to the EXF-pkg option
    for reading boundary values. This routine is called from 
    obcs_prescribe_read
  - updated obcs_check
  - changed sponge layer relaxation parameter units for days to seconds
  - turned off sponge layer by default
  - changed argument list of OBCS_CALC to myTime+deltaTclock
  - fixed about 35 bugs in obcs_external_fields_load

checkpoint55c_post
o obcs stuff
  - new runtime flags useOBCSprescribe, useOBCSbalance
  - re-arranged obcs_calc
  - moved exf_getobcs to obcs_prescibe_read
    obcs_prescibe_read is called after ORLANSKI stuff
    and independent of it (executable can contain all).
  - updated obcs_check
  - added exchanges for U,V,gU,gV for useOBCSprescribe=.TRUE.
    These may be necessary only if tangential velocities are
    prescribed at OB, not sure, needs testing.
o make the MNC_CW_ADD_VATTR_* subroutines all take scalar arguments
  which simplifies the calls and passes the ifc check-bounds test

checkpoint55b_post
o add a 2D scalar, Z location, exchange_2 routine.
o EXCH_UV for CS-grid: add one u,v in the corner-halo region, allows
  to compute vorticity on a wider stencil [e.g., vort3(0,1)&(1,0)]
  affects advect_cs results (for the wrong reason): update output.txt
o use a more standard discretization for biharmonic viscosity ; 
 (original version still available with #define MOM_VI_ORIGINAL_VISCA4 )
  affects results of dome set-up: update output.txt 
o fix gad_advection.F (CubedSphere part), back to version 1.23
o fix bug in mom_vi_del2uv.F (CubedSphere part).

checkpoint55a_post
o merged code to 
  * prescribe/read time-dependent open boundaries
    (works in conjunction with exf, cal)
  * sponge layer code for open boundaries
  * each boundary N/S/E/W now has its own CPP option
    (healthy for the adjoint)

checkpoint55
o up-to-date adjoint of previous breaks
  - natl_box_adjoint: problem for exp 12, 13: cost = 0. needs fix
  - global_ocean_ebm: adjoint still needs fix (TLM ok)
  - global_ocean.90x40x15: extended GMREDI_OPTIONS.h
  - carbon: * remove tr1-related adjoint verification
            * add ptracer as control variable
o remove all tr1-related code (ALLOW_PASSIVE_TRACER)
  (adjoint stuff still has some tr1 'names', but all use ptracer arrays)

checkpoint54f_post
o in verification/carbin/ remove experiment related to
  ALLOW_PASSIVE_TRACER (array tr1 etc)
  code_ad/ input_ad/ results_ad

o add two new packages
  - ggl90, TKE-model of Gaspar et al. (1990), Blanke+Delecluse (1993)
    + subject to optimization (memory)
  - opps, OPPS (ocean penetrative plume scheme) of Paluszkiewicz+Romea (1997)
    + subject to reordering (many GOTOs in the original code)
    + so far opps is called for every (i,j) point, and then operates in
      the vertical; one may want to reorder the scheme in order operate in
      horizontal slabs at the cost of (a lot of) memory, at least ten new 3D 
      fields)
o overhaul of IO so that we now have flags for MDSIO and/or MNC
  - all verification tests compile and run with linux_ia32_g77
  - defaults are compatible with current input files--nothing 
    should change if you were not previously using MNC
  - MNC output has been added in numerous places (eg. timeave)
    but there are still a few writes not yet do-able with MNC
    (this is in progress)
  - flags now allow for either/or/both use of MDSIO and MNC and 
    documentation will soon follow
  - numerous small formatting cleanups for ProTeX
o add version info (via BUILD_INFO.h) to MNC and stdout

checkpoint54e_post
o add two new packages
  - pp81 (Packanowski and Philander, 1981), Richardson number and 
    stratification dependent mixing
  - my82 (Mellor and Yamada, 1982) level 2 turbulence closure scheme
  - these scheme operate in a similar manner as KPP (without ghat, of 
    course), however there is only one diffusivity that is used for both
    temperature and salinity (and passive tracers)
o add offline package
o add "verification/dic_example" which contains a dic-gchem-ptracer setup
  provided by Stephanie Dutkiewicz
o genmake2: add ability to search for C compilers and cleanup test output
  - fixes recent SX-6 problems and should help with others (eg. HP-UX)

checkpoint54d_post
o data.diagnostics: if levels() is unspecified then ALL levels are diagnosed
o bug fix in pkg/cal/cal_addtime.F for TheCalendar='model' day count is wrong, 
  leading to additional shift by 5 days each year of integration
   (i.e. leading to considerable offset over the years)
o update global_ocean.cs32x15/thsice: use z* + RealFW + staggerTimeStep
o start with no AB and no initial filtering (staggerTimeStep):
  change the results of test-exp: hs94.128x64x5, hs94.1x64x5 & hs94.cs-32x32x5
o move ocean specific S/R calls from forward_step.F to do_oceanic_phys.F
  (external loading & cpl import/export stay in forward_step.F)
o update coupling interface to work with new staggerTimeStep
o change MDSIO ptracers_pickup.
o fix a bug in Flux deriv. vs Ts (pkg/aim_v23/phy_suflux_sice.F);
o genmake2 fixes so netcdf now works on halem ("osf1_alpha_*")
o bugs fixed in kpp_calc.F (ustarY) and external_forcing.F (Qsw & Partial-cell)

checkpoint54c_post
o replace surfaceTendency U,V,S,T,Tice,Ptr by surfaceForcing U,V,S,T,Tice,Ptr
  this affects (truncation error) output.txt of test-exp:
   global_ocean_ebm,_pressure,.cs32x15(&.thsice), lab_sea & natl_box
o pkg/kpp: replace pMask by maskC to reduce memory size (one 3.D array)
o change Qnet to always be the net heat flux, (+upward).
  affects (truncation error) output of natl_box exp.: updated
o define the max number of passive tracers in PTRACERS_SIZE.h
o start to test mnc routinely in exp0
o add sea-ice loading (sIceLoad) as a new forcing field.

checkpoint54b_post
o add testreport "-j JOBS" option for parallel builds (tested and pretty 
   impressive on Altix and Opteron systems)
o diagnostics can now write NetCDF files through the mnc package
o staggerTimeStep & NLFS: update pkg aim_v23 & thsice; update aim.5l_cs output
o staggerTimeStep & multi-Dim-Advec: Exch(U,V) added 
o staggerTimeStep & NLFS: rescale T & S surface tendencies.
  affects (truncation error) output of lab_sea & natl_box exp.: updated
o change pickup _cd & _ptracers (old pickup restart: usePickupBeforeC54=.T.)

checkpoint54a_post
o re-write staggerTimeStep: step fwd U,V and then T,S (reverse the order).
o change pickup file (to restart from old pickup, set usePickupBeforeC54=.T.)
o get a perfect restart when using RealFreshWaterFlux + NLFS (not finished)
o update output of all exp. that use staggerTimeStep (except hs94.cs & 2D)
  + internal_wave (shift in writing cg2d_ini_res)
checkpoint54a_pre

o require forcing_In_AB=.FALSE. and remove surfaceTendencyTice from pkg/seaice
  - modified verification/lab_sea and natl_box_adjoint accordingly

checkpoint54
checkpoint53g_post
o prepare splitting of thermodynamics: store convect.counter in common block
o store d.etaH/dt (instead of Div.hV) in common ; affects (truncation error)
  output of: global_ocean.cs32x15, global_ocean_pressure & internal_wave
o cnh's modifs to gad_advection.F for cube-sphere multi-dim advection
o new parameter "nShapS": allow to treat differently S from T (nShapT)
o separate Vert.Advec.Scheme from horizontal Advec.Scheme (T & S)
o restore adjointability

checkpoint53f_post
o modifications that affect AIM experiment results (update output.txt):
  - no advection of S at top interface Nr (pkg/generic_advdiff) 
  - air surf. temp: use lower value between T0 & T1 (phy_suflux_prep.F)
o AIM pkg:
  - include stability function into surf.Flux derivative relative to Tsurf
  - calculate clear-sky radiation & surface temp. change (for diagnostics)
 
checkpoint53e_post
o merged cylindrical coord configuration
o added rotating_tank experiment
checkpoint53e_pre

checkpoint53d_post
o faulks upgraded: re-generate output.txt that have changed:
   global_ocean.cs32x15(.thsice), global_ocean_ebm, lab_sea, natl_box
o Added Bryan and Lewis, 1979, vertical diffusivity profile
o pkg/land: fix problem in land_impl_temp.F when Ts arround freezing. 
o added Sadourny discretization of Coriolis
  - moved some PARAMETERS from mom_*_coriolis.F to PARAMS.h
  - re-enabled use of omega3 (useAbsVorticity)
o added Leith (Phys. Fluids, 1968, 10, 1409-1416) variable viscosity for
  vector-invariant equations
  - note: does *NOT* yet use same variable visc. for no-slip BC's.
o recoded the lateral boundary conditions for non-hydrostatic w, this time
  hopefully without new bugs
  - still to do: biharmonic friction for non-hydrostatic w
o bug fix for mom_*_sidedrag: rA -> rAs,rAw
o regenerated output for global_ocean_ebm (using -ieee)
o fix mom_common/mom_*_sidedrag.F to recover numeric output prior to creation
  of mom_common/
  - simple re-arrangement of instructions within computing loop
checkpoint53d_pre

checkpoint53c_post
o new version of coupler for AIM+thSIce and Ocean models
 - new fields (SSS,h_MixLayer ...) are exchanged through the coupler
 - land: change Evaporation of snow
 - aim with thSIce: fix bug in snow-precip.
o changes to calc_gw.F
 - bug fix for w^2 term near the bottom boundary
 - (hopefully) improve the lateral slip boundary condtions for use with
    partial/looped cells
  - because the bug fix changes two verification experiments anyway (exp5
    and plume on slope), change the lateral boundary condition from half slip
    to the value of no_slip_sides
o ebm package wasnt quite up to the parallel task. Fixed that.
o Adjoint of EBM package + verification
  * TLM OK
  * ADM not sufficient accuracy yet (needs further testing)

checkpoint53b_post
o Commiting new energy balance model to repository
  * package is pkg/ebm
  * verif. is verification/global_ocean_ebm
  * references are in ebm_driver.F
C      * X. Wang, P. Stone and J. Marotzke, 1999:
C        Global thermohaline circulation. Part I:
C        Sensitivity to atmospheric moisture transport.
C        J. Climate 12(1), 71-82
C      * X. Wang, P. Stone and J. Marotzke, 1999:
C        Global thermohaline circulation. Part II:
C        Sensitivity with interactive transport.
C        J. Climate 12(1), 83-91
C      * M. Nakamura, P. Stone and J. Marotzke, 1994:
C        Destabilization of the thermohaline circulation
C        by atmospheric eddy transports.
C        J. Climate 7(12), 1870-1882
o Will need long integration testing.
checkpoint53b_pre

o created pkg/mom_common in preparation for variable viscosity code
o renamed and split ini_mnc_io
o pkg/land: only liquid water can diffuse or run-off
o AIM using land: soil wetness availability account for snow
o added printMapIncludesZeros to EEPARMS namelist

checkpoint53a_post
o restore TAMC compatiility for exf_constants.h
  (no usage of _d in .h)
o Additional storing in KPP in an attempt to fix
  TAMC problem with adjoint of KPP code.
  (no success...)
  Identical code works fine with TAF.
o Fixed verification/natl_box_adjoint experiments.
  Initial conditions for Experiments 4 and 5 are now
  set to "SEAICE_initialHEFF=0", which is more reasonable,
  and hence gives results closer to that of Experiment 2.
  Experiment 6 requires "SEAICE_initialHEFF=1" and is working once again.

checkpoint53
o stable checkpoint with up to date adjoint
  TLM tests only run for 1st grdchk at the moment. Its unclear if
  this is a code problem or a problem with resetting code for g_
  variables that is being autogenerated wrong.
  Otherwise:
   o code is testing well on Linux (P4 and AMD), SGI Alitix and Irix. 
   o IBM and HPQ tests could not be run because NCAR (IBM) and NCCS (HPQ) 
     are both still in chaos following their security messes.

checkpoint52n_post
o various build (mostly genmake2) changes including:
  - ability to build/run more easily within Cygwin and MacOS X
  - more complicated Makefiles with a stronger dependence on Gnu Make
o pkg/seaice modifications
  - added SEAICE_deltaTtherm and SEAICE_deltaTdyn in order to reduce cost
    of pkg/seaice.  For time being, SEAICE_deltaTtherm = deltaTtracer
    and SEAICE_deltaTdyn must be integer multiple of SEAICE_deltaTtherm
  - changed proxy for geostrophic velocity and updated 
    verification/lab_sea/results/* accordingly
  - removed ADI dynamic solver from pkg/seaice
  - replaced all occurrences of 1/CSTICE or 1/CSUICE
    they caused a segmentation fault under certain circumstances
  - removed unused field WATR
o bug fix in exf-package:
  -  u/vwind are defined at tracer/pressure points. The values of u/vwindmask
     now reflect that.
o small fixes in the cal-package:
  - set reference date to first of January for the 'model'-calendar
  - failing of cal_CheckDate in cal_FullDate now actually results in a
    warning
o small modifications in exf-package to increase flexibility:
  - change climtempfreeze from a constant to a runtime parameter that
    is specified in data.exf_clim (default = -1.9)
  - introduce runtime parameter windstressmax (default = 2.0) that is
    specified in data.exf
o fix in pkg/thsice:
  - update Evap (Tsf changes) to be consistent with Latent heat flux
  - maintain snow precipitation unchanged (even if Tsf >=0).
 both affect global_ocean.cs32x15/(.thsice) results ; update output.txt.thsice

checkpoint52m_post
o commented out call to cal_GetMonthsRec in swfrac.F and added some comments;
  this does not change any of the results, because myIter=0 in swfrac always
  lead to jwtype=2 (the default anyway), but the call makes little sense
  as a default
o no SHORTWAVE HEATING lost at the bottom; affects lab_sea output; updated
o re-work pkg/thsice interface with ocean & bulk_force pkg to allow
  atmospheric model (AIM) to use it ; add a "slab ocean" component.
o pkg/aim_v23 : add interface to call thermodynamic sea-ice (thsice)
o update global_ocean.cs32x15/output (.thsice) after changes in pkg/thsice
o extending useSingleCpuIO option to work with new exch2 I/O format
  - old-style, missing-tile I/O is still accessible by defining CPP
    option MISSING_TILE_IO in pkg/mdsio/MDSIO_OPTIONS.h
o monitor package can write to NetCDF files and/or STDOUT
o fix re-definition bug in MNC_GRID_INIT_ALL()
o doc/api_reference added
  - a framework for building an API Reference Manual using all
    the "protex" comments embedded in the code
  - see pkg/generic_advdiff, pkg/mnc for examples
o MNC:
  - make myThid the last argument for all subroutines
  - new default for the grid files: NO halos
  - add useMNC and other run-time flags
  - separate per-file-group handling of the unlimited dimension
  - early initialization of MNC w/ flags read at the eeboot stage 
    and lookup tables set in initialize_fixed
  - write all MNC output to a freshly-created directory
o thermodynamics sea-ice (thsice) is now tested with testreport.
o test exp. advect_cs: use the standard cs32 grid ; update output.
o Added functionality to grdchk:
  pick global i,j,k position (or nearest wet) where to perform check.

checkpoint52l_post
o new land formulation:
  a) use ground enthalpy as prognostic variable to ensure exact
     energy conservation.
  b) account for water temperature and for latent heat of freezing
     in all processes (rain, run-off, ground storage)
  c) compute surface and ground temperature implicitly.
o aim_v23 modification for new land model:
  a) Treat separately land / ocean / sea-ice surface fluxes
     to allow implicit computation of land & sea-ice surface temp.
  b) add snow precipitation.
checkpoint52l_pre

o fix problem (when 1 tile is empty) in min/max monitor.
o fix bug in timeAve (u,vZetatave in common block) 
o no restoring terms under ice for pkg/seaice
o moved SEAICE_DO_DIAGS to S/R do_the_model_io
o bug fix for pkg/seaice pickups
o change MNC call locations and add coordinate attributes
o mask vorticity at the corner ; affects global_ocean.cs output
o fix ini_curvilinear_grid ; test CS experiments with mpi
o aim.5l_cs: modify sea-ice fraction input file ; update output
o exf: Adding simple range check routine for exf fields after read

checkpoint52k_post
o removed top-level directory "diags"
  - we migrated these functions to pkg/timeave a long time ago
o fixed bug introduced in pkg/monitor
o accuracy ctrlprec = 32 insuffient for gradient checks using
  averaged fields (I/O via cost_averages)
  -> use ctrl.h in active_file*.F to control I/O precision.
o paramter list of CALL ADTHE_MAIN_LOOP
o added initial do_the_model_io to ecco
o set all ...Freq to zero after cost_final
  taveFreq, dumpFreq, pChkptFreq
o MAIN and ECCO differentiability restored

checkpoint52j_post
o fix nchklev in tamc.h for global_ocean...
o Bringing flow and store directives up-to-date
o Really weird thing!
  call do_the_model_io from the_main_loop with parameters
  starttime, niter0, instead of mytime, myiter, screws up the adjoint: 
  TAF places a faulty re-call of initialise_varia
  after cost_final call which should not be there!
checkpoint52j_pre

o tweaked pkg/mdsio/mdsio_readfield.F to have more useful logic and
  error messages
o fix errorMessageUnit problem. remove old version of mdsio from eesup/src
o modified pkg/mdsio/mdsio_readfield.F -- commented out diskspace-eating
  debug output
o modfied mdsio_writefield.F to handle non-global files under exch2
o update AIM Cubed-Sphere exp (aim.5l_cs):
  use land, p*, and Franco.M forcing fields with fractional land-sea mask.
o update AIM Equatorial Channel exp:
  use standard aim_v23 pkg and change the SST fields to be more realistic.
o globalFile now works with exch2
o merged mom_vi_calc_relvort3.F, mom_vi_del2uv.F and 
  mon_vort3.F to make exch2 friendly with >1 tile per cube face
o limit timeave output for hi-res integrations

checkpoint52i_post
o removed CPP_EEOPTIONS.h from verification/*/code
o updated the tiling for global_ocean_pressure
checkpoint52i_pre

o update aim.5l_LatLon using the standard aim_v23 pkg (instead of 
  the old pkg/aim).

checkpoint52h_pre
o shortened offending lines in exch2_send_rx?.template
o modified W2_EXCH2_TOPOLOGY.h to reflect current topology generator
o genmake2: add build & execute test for NetCDF code
o modded aim.5l_cs and global_ocean.cs32x15 to use exch2, removed
  old grid files, moved CPP_EEMACROS.h to pkg/exch2
o added useSingleCPUIO flag to monitor.F and mon_out.F
o added temporary hack for sea-ice dynamics on the cube:
  metric terms are ignored and it is assumed that
  there is no sea-ice on cube faces 1, 2, 4, and 5.

checkpoint52f_post
o added exch2 cube routines to pkg/exch2
o modified hs94.cs-32x32x5 to use it
o added new grid files to hs94.cs-32x32x5
checkpoint52f_pre

checkpoint52e_post
o first attempt to solve vertical advection (momemtum & T,S) Implicitly
  for now, only implemented with Lax-Wendroff (tracer) and VectInv (mom)
o step.1 : rewrite (as in MultiDimAdvec) explicit tracer stepping (gad_calc_rhs.F)
  to work with implicit vertical advection and AB ;
o Implic. vert. advect. implemented with flux-limiter, c2, u3 and c4 scheme.
o update output (gad_calc_rhs.F changes affect truncation error) of exp:
 front_relax, global_ocean .cs32x15 & _pressure, internal_wave, lab_sea, natl_box
checkpoint52e_pre

o fix bug in impldiff when Nr=1 or Nr=2.
o change the albedo in pkg/thsice (as GISS model); update output_thsice.txt
o little changes (fftpack, aim/phy_suflux ...) to pass the "checkbounds" test.
o fix deltaTfreesurf in update_cg2d.F (left from c45d_post): affects 2
  ocean exp. that use NLFS: global_ocean.cs32x15 & global_ocean_pressure
o added exf_offset_atemp for Celsius to Kelvin conversion of atemp
o eesupp/inc/EEPARAMS.h: MAX_NO_PROCS=1024
o pkg/cal/cal_toseconds.F fix for long (>60 years) integrations

checkpoint52d_post
o re-tiled many expts to allow comparison in multi-processor mode
  - updated output accordingly
  - changed hs94.128x64x5 to use intial T from file rather than use the
    random number generator
o add infrastructure in model routines for fizhi and gridalt packages
o change global_ocean.cs32x15 because of Pb with GM on CS-grid.
o changes to permit hi-res, cubed-sphere, configuration
  - added useSingleCpuIO capability to mdsio_readfield.F and exf_interp.F
  - added "#undef ALLOW_USE_MPI" support to eesupp/src/scatter_2d.F
  - added pkg/exf/exf_set_uv.F for on-the-fly interpolation and rotation
    of surface winds for the cube
  (A verification experiment, based on global_ocean.cs32x15, but with
   pkg/seaice turned on and with on-the-fly interpolation from the NCEP
   Gaussian grid is described in MITgcm_contrib/high_res_cube/README_ice,
   complete with example surface forcing files and matlab scripts to look
   at the output and compare it with that of global_ocean.cs32x15.)
o packages pickup: $PKG_write_pickup called from packages_write_pickup ;
   but call to $PKG_read_pickup remains in $PKG_ini_vars: change CD_code
   to conform to the common rule.
o check-in the first version of the coupler + interfaces for multi-components 
   set-up (Chris's version, adapted to work on cubed-sphere grid); use MPI.
   - imply modification in eesupp (MPI_COMM_MODEL < MPI_COMM_WORLD).
   - atmosphere: use pkg aim_v23 ; no sea-ice for now. 
   - ocean and atmos. share the same horizontal grid (no interpolation).
   - exchanges between component and coupler is done in forward_step
o new verification experiment, cpl_aim+ocn: 
   coupled ocean - AIM atmosphere on cs32 grid. 

checkpoint52d_pre
o surface flux time-av diagnostic modified for NLFS & RealFreshWater 
o add call to AIM pendant S/R in external_forcing & external_fields_load.F

checkpoint52c_post
o Fixing OPTIONS files for use of exf:
  - ALLOW_ECCO not needed
  - ECCO_CPPOPTIONS.h should not be included from
    EXF_OPTIONS.h/CAL_OPTIONS.h, but from CPP_OPTIONS.h
    as has been the case in the past
  - All cal/exf related options are currently set in
    single header file. Should remain so until we
    agree on a consistent new policy.
o Removed all CPP options for cal package.
  cal has no more CPP options.
o modified STOREs in GAD_ADVECTION
o corrected key comp. for passkey

checkpoint52b_post
o new version: "thsice" of thermodynamic sea-ice pkg:
 - only 1 call from "forward_step"; conserve energy, fresh-water & salt. 
 - modify fluxes but do not change theta directly;
 - light cleaning of bulk_force pkg (still needed with thsice).
 - add forcing fields + data files in global_ocean.cs32x15/inp_thsice 
   + output_thsice.txt to test thsice & bulk_force pkgs.
o put back grid & coriolis monitor output.
checkpoint52b_pre

o call "do_the_model_io" at the beginning (=> dump initial state) 
o use rhoConstFresh to define convertEmP2rUnit (was done only in ocean-P)
o sort out interplay between tamc.h and PTRACERS_OPTIONS.h
  (need info on NUMBER_OF_PTRACERS)
o missing PTRACERS headers in some routines
o default tamc.h in pkg/autodiff supposed to crash
  to ensure proper customization

checkpoint52a_post
o modifications to make FREEZE (_SURFACE) flux visible to pkg/kpp
  - moved surfaceTendencyTice from pkg/seaice to main code
  - subroutine FREEZE_SURFACE now limits only surface temperature
    and is called in FORWARD_STEP (if allowFreezing=.TRUE.)
    => new output.txt for global_ocean.cs32x15 & global_with_exf
  - keep the old version of FREEZE for backward compatibility;
    global_ocean.90x40x15 left unchanged using useOldFreezing=.TRUE.
  - corresponding modifs for TAF directives
o added surface flux output variables to TIMEAVE_STATVARS
o time-averaged output for pkg/ptracers
o fix problem with ECCO-related divided adjoint
  snapshot file was missing some ad-variables,
  but no warning issued by TAF

checkpoint52a_pre
o some bug fixes for #undef REAL4_IS_SLOW

checkpoint52 = ecco_c52_e35
o after testing adjoints of checkpoint51u_post

checkpoint51u_post
o this is the post-merge tag of the ecco-branch
  (needs another clean checkout and re-testing)
o various natl_box_adjoint configs and results
  but no input fields
o obcs adjoint not yet merged!
o adding ECCO global 1x1 and 2x2 degree configs
o updated/extended some store directives for seaice
o pkg/ecco now containes ecco-specific part of cost function
o top level routines the_main_loop, forward_step
  supersede those in model/src/
  previous input data.cost now in data.ecco
  (new namelist ecco_cost_nml)
o in ctrl/ cleaned some cross-dependencies and updated CPP options

checkpoint51t_post
o this is the pre-merge tag of the ecco-branch

checkpoint51s_post
o cleanup: removed various obsolete #define-s
o pkg/grdchk
  - renamed 'ph-grd 3' to 'grad-res'
  - merged from ecco-branch 
    (remaining bug fixes for obcs gradient checks)
  - additional high-precision output for testreport
    (grep for 'precision_grdchk_result')

checkpoint51r_post
o cleaned up or removed CPP_OPTIONS.h files
o updated results for some of the tests to reflect the new
  optfiles (-ieee: -O0 instead of -O3)

checkpoint51q_post
o cd_code:
  - moved cd_scheme.F -> cd_code_scheme.F
  - separate read_checkpoint from cd_code_ini_vars.F
  - separated cd_code part from write_checkpoint
  - updated AD_SOURCE, generated .flow
  - added CD_CODE_VARS.h to the_main_loop
  - Moving cd_code specific store dir.s to pkg/cd_code
o ctrl package totally restructured
  - pack/unpack now optional and decoupled from
    xx_/adxx_ I/O
  - ctrl_pack/unpack cleaned
    (new routines ctrl_init_ctrlvar.F, pkg/ctrl/ctrl_init_wet.F)
  - confined inclusion of AD_CONFIG.h to where necessary.
o genmake2: changed AD dependencies from SRCFILES to AD_FILES

checkpoint51p_post
o create initial cd_code package
  - WARNING: the initialization of fields within packages
    is broken because INI_FIELDS (where READ_CHECKPOINT is
    called) is called *before* PACKAGES_INIT_VARIABLES.
    This seems to be backwards since
    1) its important to initially zero the entire field including 
       the "halo" region
    2) zeroing needs to be done *before* reading pickup info
       and the pickup call might or might not happen in any 
       particular run
  - this needs an overhaul for R2
o cleanup verification/*/code/GMREDI_OPTIONS.h
o cleanup testreport

checkpoint51o_post
o bringing AD-related verif's up to date with genmake2
  - carbon/
  - global_ocean.90x40x15/
  - hs.94.1x64x5/
  - (front_relax/ )
o (more) consistent directory structure for AD-related verif.'s
o cleaning ALLOW_GRADIENT_CHECK -> ALLOW_GRDCHK
o cleaning some ALLOW_TANGENTLINEAR_RUN -> ALLOW_AUTODIFF
o bug fix in find_alpha.F for MDJWF:
  - modif. to alpha = 1/D*( dN/dT - rho*dD/Dt) to account for
    change rho -> rho-rhoConst
  - replace call find_rho to find_rhonum
o initialisation of rFlx extended to full array (required by TAF)
  and shifted to thermodynamics
o removed PTRACERS.h in ptracers routine
o added surfacetendencyPtr to S/R parameter list pracers_forcing
o Correcting initialisations for fVerU, fVerV.
o helping TAF to recognize dependency on kUp for
  fVerU, fVerV
o Replacing delZ by delR in pkg/ctrl/
checkpoint51o_pre

o undid all of cp51 pending some cleanups and discussion
o added the [#include "AD_CONFIG.h"] statement to all files that need 
   it for adjoint/tl #defines
 o re-worked the build logic in genmake2 to support AD_CONFIG.h
 o removed tools/genmake since it no longer works

checkpoint51n_post
o modifications to make FREEZE flux visible to pkg/kpp
  - moved surfaceTendencyTice from pkg/seaice to main code
  - FREEZE & EXTERNAL_FORCING_SURF moved to FORWARD_STEP
  - subroutine FREEZE now limits only surface temperature
    (this means new output.txt for global_ocean.90x40x15,
     global_ocean.cs32x15, and global_with_exf)
o added surface flux output variables to TIMEAVE_STATVARS

checkpoint51n_pre
o added "#undef ALLOW_USE_MPI" support to eesupp/src/gather_2d.F
o added [#include "AD_CONFIG.h"] to all files that use the following
  defines:
  - ALLOW_ADJOINT_RUN
  - ALLOW_TANGENTLINEAR_RUN
  - ALLOW_ECCO_OPTIMIZATION

checkpoint51m_post
o incorporating changes to get TAMC/TAF working in genmake2
  - added new TAMC/TAF targets to the Makefile
  - various cleanups related to package handling
  - these changes should have no impact on the forward model

checkpoint51l_post
o changes to pkg/cal and pkg/exf that allow and speed-up long integrations
 - faster algorithm for cal_addtime.F
 - higher precision arithmetic, where needed
 - pkg/exf *startdate variables changed from calendar date to
   model integration time

checkpoint51l_pre
o add salt flux to forcing fields (used when salty sea-ice forms or melts)
o enable to apply restoring on S & T only in a latitude band.
o update output (external_forcing_surf modif. change truncation errors)
   global_ocean.cs32x15, global_ocean_pressure, lab_sea, natl_box

checkpoint51k_post
o change default to: useNHMTerms=.FALSE.
 - new output.txt for atmos. exp (NHMTerms were wrong but now turned off):
   adjustment.128x64x1, aim.5l_Eq_Ch, aim.5l_LatLon, hs94.128x64x5, hs94.1x64x5
 - new output.txt for idealized oceanic exp (NHMTerms are now turned off):
    exp1, ideal_2D_oce
 - change data file of oceanic exp (leave the results unchanged for now)
   exp2, global_ocean[90x40x15,pressure,with_exf], lab_sea, natl_box
o set gravitySign automatically according to the vertical coordinate used
  (and change sign: back to "logical" value: +1 when R increases downward)
o added an include barrier to the default CPP_OPTIONS.h and 
  removed the #include "PACKAGES_CONFIG.h" from it
o fix a bug in mom_fluxform (from chk51j_post)

checkpoint51j_post
o Added some AD-related initialisations in mom_vecinv/ mom_fluxform/
o adjusted some flow directives (dynamics, thermodynamics)
o added cubed-sphere case to test cost function
o heckpoint_lev?_directives.h now include
  pkg-specific directives, whenever those are enabled.
o Moving pkg-specific flow directives to corresponding pkg
  Moving pkg-specific differentiation list to corresponding pkg
  Moving pkg-specific checkpoint-lev storing to corresponding pkg
  ---> conventions are
       - pkg_ad.flow
       - pkg_ad_diff.list
       - pkg_ad_check_lev?_dir.h

checkpoint51i_post
o merge of the branch-genmake2
  - knowingly breaks the older genmake
  - automatic generation of all ALLOW_${PKG_NAME} defines
  - new testreport supersedes older testscript
o large number of package inclusion and header cleanups
checkpoint51i_pre

o new output for adjoin of global ocean vector invariant
o fix for checkpoint of thermodynamic seaice and bulk_force
o Steph gchem various cleanups

checkpoint 51h_pre
o fixed some single quotes
o modify gchem pkg to be more versatile
o modifications to clean up dic pkg
o add pkg/cfc

checkpoint51g_post
o provide links for ARPACK and ADM*TLM
o start removing verification/vero/
o update AD-related stuff
  (in particular some IF-statements in model/src/ routines)
o adding to verification/global_ocean.90x40x15/ adjoint of
  vector invariant setup

checkpoint51f_post
o update advect_xz/output.txt (left from chekpoint50f_pre, ini_vel modif)
o Mods and bug fixes to pkg/cal, pkg/exf, etc., needed for computation
  of tracer Green's fucntions for ocean inversion project.

checkpoint51f_pre
o Added on-the-fly spatial interpolation capability
    "USE_EXF_INTERPOLATION" to pkg/exf.
  - This is a temporary Cartesian-grid hack until
    the super-duper ESMF coupler becomes available.
  - See verification/global_with_exf/README for usage example.
  - Removed obsolete EXFwindOnBgrid and SEAICEwindOnCgrid
    flags and modified pkg/seaice accordingly.
o Bug fix to pkg/ptracers, pkg/generic_advdiff/gad_calc_rhs.F,
    and pkg/kpp/kpp_transport_ptr.F for dealing with tracer
    non-local transport term.

checkpoint51e_post
o pkg/mom_vecinv: 
  - changes related to hFac: use S/R from aim.5l_cs/code (coriolis & vort.advec)
  - add time-ave diagnostic of vorticity advection.
o add diagnostic (instantaneous) of Shapiro Filter effect for T,S & UV.
o atmospheric geopotential: - include water vapor effect; 
                            - use p^kappa in p* scaling.
o land pkg: read initial state from files.
o AIM : add stratospheric drag in the upper level

checkpoint51d_post
o change function ILNBLNK (=> last non-blank char.) to return zero
  (instead of the string length) when the string. char is empty
o fix bug in dxV,dyU definition of cubed-sphere grid (ini_curvilinear_grid)
o modif's to restore TAMC compatibility
  - avoid "_d" constructs in PARAMETER declarations
  - avoid interrupting lines by comment lines
o Use cluster local disks for purely local I/O
  vs. globally visible disks needed for ctrl stuff
  (merged from ecco-branch)
  - new active_file_loc... and mdsio_..._loc routines
  - affected packages: autodiff, ctrl, grdchk, mdsio

checkpoint51c_post
o introducing integer flag debugLevel
  - debLevZero: suppress all output
  - debLevA: standard
  - debLevB: equivalent to current debugMode=.TRUE.
o introducing pathname variable mdsioLocalDir for mdsio
  that can be specified at runtime
  (relevant for cluster I/O to local disk)
`
>>>checkpoint51b_post
adjoint of ptracers
o disentangled ALLOW_PTRACERS using new ALLOW_GCHEM
o extended state in checkpoint_lev?, etc.
o alternative ctrl/cost with tr1 or ptracer
o new comlev1_bibj_ptracers
o new ptracers.flow
o made ptracers_forcing same as external_forcing_s
o added verification for adjoint with ptracers
  - adm. grdchk fail so far
  - tlm. grdchk OK
  - checked tapelev/comlev recomputations: OK
<<<checkpoint51b_pre

checkpoint51a_post
o added code for biogeochemistry package
  - new pkgs: dic, gchem
  - new subroutine in ptracers
o modify code for biogeo packages
  - in model/src and pkg/ptracers

checkpoint51
o merged improved packages from ecco-branch (ecco_c51_e34) to MAIN
  - autodiff, ctrl, exf, grdchk, seaice
  kept separate packages
  - cost, ecco, obcs
o updating verification/internal_wave, verification/lab_sea
  (all verif's pass on faulks.lcs.mit.edu RH7.3, g77)

checkpoint50i_post
o Preparing next differentiable checkpoint and sync
  of MAIN vs. ecco-branch
  - 1st step: this one is differentiable
  - 2nd step: next(! not this) checkpoint will have updated packages 
              from ecco-branch)

checkpoint50h_post
o new package "land": provide surface BC for AIM.
o pkg/ptracers: apply exchange to all tracers after reading a pickup.
o AIM: use true log-P extrapolation for near surface temp (= as in 
    F.Molteni paper) ; update aim.5l_cs output.
o New variable in PARM03 for more flexible pickups
o somewhat cleaned package initialisation sequence for
  ctrl/ cost/ ecco/ in packages_... routines

checkpoint50g_post
o merged with release1_p17 (pkg/seaice and verification/lab_sea)
  - added SEAICE_MULTILEVEL for 8-category sea-ice thermodynamics
  - LSR sea-ice dynamic solver moved to SouthWest B-grid location and
    made the default because of faster convergence than ADI

checkpoint50f_post
o exf totally restructured
  - replaced all exf_set_ routines by one generic exf_set_gen.F
    and made sure it's still differentiable
  - split exf_getffields.F into new exf_bulkformulae.F
  - exf_inscal_/exf_outscal_ suffixes consistent with field names
  - updated adjoint/makefile and relevant verif. accordingly

checkpoint50f_pre
 o AIM: near surface temp evaluated from Pot.Temp: fixed for Part Cell ;
      + change Evap over land. (update aim.5l_cs output)
 o added missing .cvsignores and made uniform across expts
 o changed configuration of tidal_basin_2d expt
 o added pkg/debug functions for tracing code in fatal crashes
 o tidied pkg/monitor to use MONITOR_OPTIONS.h
 o new fn in pkg/monitor to stop model if solution grows too big
 o removed lots of single quotes from comments

checkpoint50e_post
o make KPP work with PTRACERS
 - fix gad_calc_rhs to call new routine kpp_transport_ptr, which is
   nearly a copy of kpp_transport_s
 - there is no analogue to SurfaceTendencyS, so I have to use 
   gPtr(of the surface layer) instead
o add a new platform SunFire+mpi (SunFire 15000) to genmake
checkpoint50e_pre

checkpoint50d_post
o change kpp output from multiple-record state files to single-record state 
  files analogous to write_state.F
o reduce the output frequency of cg3d-related stuff to the monitor frequency, 
  analogous to the cg2d-related output. 
o fix small problem with in ptracers_write_checkpoint.F: len(suff)=512, 
  so that writing to internal file fn (with length 512) fails.
checkpoint50d_pre

checkpoint50c_post
o fix problem in ini_procs.F when using MPI (was there since checkpoint48f)
o add monitor diagnostic of vorticity (mon_vort3.F) and potential energy.
o add time-average diagnostic of U*V and vertical diffusive flux for theta.
o bug fixed in convective adjustment diagnostic (multi-tile set-up).
o 4th Order Adv scheme: return to previous (c40pre7) masking near boundaries.

checkpoint50c_pre
Merging from release1_p13:
o bug fix for pkg/seaice dynamic solver
o Added SEAICE_initialHEFF to pkg/seaice

checkpoint50b_post
o store u*,v* in gU,V instead of in guNm1,gvNm1
o in order to put the momForcing out of the Adams-Bashforth:
  move forcing & CD-scheme calls from mom_fluxform & mom_vecinv
  to timestep.F
o new flag "useCDscheme" (default=F); replace guCD,gvCD by local arrays
o re-generate output for highly sensitive test-exp:
   global_ocean_pressure, ideal_2D_oce, lab_sea, natl_box

checkpoint50b_pre
o restore the use of momAdvection & useCoriolis flags (mom_vecinv)
o corrected CPP option mismatch in exf_Bulk... functions for case 
  #define ALLOW_ATM_WIND && #undef ALLOW_ATM_TEMP

checkpoint50a_post
o Bug fix for merging between c50 and KPP.
  ikey was passed from thermodynamics to kpp_calc via
  common block rather than being recomputed in kpp_calc,
  in contradiction with new key itdkey.
  New key ikppkey created, and tamc.h headers updated.

checkpoint50
- 2nd step of merge with ecco-branch:
  merge changes in ecco-branch back into main trunk
- bug fix in find_alpha
- more storing in gmredi_calc_tensor.F, kpp_routines.F
- avoid iterative loop in ini_pressure for ALLOW_AUTODIFF_TAMC
- merged some sliced AD support routines

checkpoint49
merged from ecco-branch:
o exf:
  - Enable initialisation of forcing fields to constant 
    (runtime) values.
  - in exf_getffields.F
    Reduce i-/j-loop to interior domain, discarding overlaps.
    That also fixes wrong TAF-key computations for key_1, key_2
    with bulf formulae.
  - exf_init.F modify #ifdef for exf_init_evap
  - exf_getffieldrec.F, ctrl_getrec.F
    The following INT-usages are not safe:
      fldsecs  = int(fldsecs/fldperiod)*fldperiod
      fldcount = int(fldsecs/fldperiod) + 1
    and were modified.
o autodiff: checkpoint_lev...
  - updated storing for bulk formulae (some arrays were missing)
  - added state for seaice package
  - synchronized with main branch
o DIVA:
  Modif.s in
  - the_main_loop.F
  - the_model_main.F
  and added cost_final_restore.F cost_final_store.F
  o With these changes, it is possible to fully separate
    the first forward run to compute the cost function (mdthe_main_loop)
    and adjoint runs over individual DIVA intervals (adthe_main_loop)
    into separate model executions.
    This enables better tuning of DIVA to given queue sizes.
  o Loss of cost function value in consecutive DIVA runs is
    fixed by storing to 'costfinal' file.
  o Appropriate call of ctrl_unpack/_pack,grdchk_main at 
    beginning/end of adjoint integration is accounted for.
  The current changes apply to TAF-1.4.26.
  TAF has one remaining bug, requiring one manual change
  (see MITgcm manual).
o cal: synchronized between MAIN and ecco-branch

checkpoint48i_post
o Changes to restore differentiability of code w.r.t. previous tag
  (mostly adding new routines to make list and replacing
  pressure by totPhiHyd).
o Updated and merged grdchk package
  - has both ADM and TLM checks
  - works for single- and multi-proc.
  - output cleaned
  - worked successfully for parallel DIVA
o genmake:
  - Adding -platform=SP4
  - Modif. for DEC Alpha (many don't have makedepend; use mkdep instead).
o Modif. for DIVA:
  ctrl_unpack should not be called in intermediate DIVA interval.
  (similar thing would apply for active files such as
  tbar, sbar, psbar, which should not be reinitialised;
  only relevant for ecco-branch)

checkpoint48h_post
o improve "ini_p_ground" when using finite difference form for calc_phi_hyd
o Added net flux to downward flux conversion to pkg/exf/exf_getffields.F
o Added SEAICE_initialHEFF to pkg/seaice
o ecco_the_model_main.F: SEAICE_WRITE_PICKUP must precede WRITE_CHECKPOINT

checkpoint48g_post
--- EOS:
o compute locally the pressure for use in EOS: UNESCO, JMD95P, MDJWF
  store total Potential in totPhyHyd for diagnostics & EOS.
o fix restart and overlap Pb when using Z-coord and EOS funct. of P
--- Pressure/geopotential gradient:
o use Ro_surf & R_low instead of hFac in cal_phi_hyd:
o NLFS + p-coord.: eta*Alpha' is not longer lagging 1.time-step behind
  ( changes results of global_ocean_pressure )
o NLFS + z-coord.: add eta*Rho' contribution.
o accurate phiHyd when using interface-W at the middle between 2 centers
 ( changes results of ideal_2D_oce )
o includes r* 2nd term in potential gradient.

checkpoint48f_post
Merging from release1_p12:
o Modifications for using pkg/exf with pkg/seaice
  - improved description of the various forcing configurations
  - added basic radiation bulk formulae to pkg/exf
  - units/sign fix for evap computation in exf_getffields.F
  - updated verification/global_with_exf/results/output.txt
o Added pkg/sbo for computing IERS Special Bureau for the Oceans
  (SBO) core products, including oceanic mass, center-of-mass,
  angular, and bottom pressure (see pkg/sbo/README.sbo).
o Lower bound for viscosity/diffusivity in pkg/kpp/kpp_routines.F
  to avoid negative values in shallow regions.
  - updated verification/natl_box/results/output.txt
  - updated verification/lab_sea/results/output.txt
o MPI gather, scatter: eesupp/src/gather_2d.F and scatter_2d.F
o Added useSingleCpuIO option (see PARAMS.h).
o Updated useSingleCpuIO option in mdsio_writefield.F to
  work with multi-field files, e.g., for single-file pickup.
o pkg/seaice:
  - bug fix in growth.F: QNET for no shortwave case
  - added HeffFile for specifying initial sea-ice thickness
  - changed SEAICE_EXTERNAL_FLUXES wind stress implementation
o Added missing /* */ to CPP comments in pkg/seaice, pkg/exf,
  kpp_transport_t.F, forward_step.F, and the_main_loop.F
o pkg/seaice:
  - adjoint-friendly modifications
  - added a SEAICE_WRITE_PICKUP at end of the_model_main.F

checkpoint48e_post
o New S/R for diagnostic of bottom pressure (phi0surf was missing in c48d_post)
o dynamics: change definition of computational domain & adapt mom_fluxform
  accordingly ; when viscA4=0, allows to run the dynamics with Olx=Oly=2. 
o following exp works with Olx=Oly=2 (and pass through checkbounds option):
    adjust_nlfs.cs-32x32x1 adjustment.128x64x1 adjustment.cs-32x32x1
    exp0 exp1 exp2 exp4 exp5 hs94.cs-32x32x5 hs94.128x64x5 hs94.1x64x5
    global_ocean.90x40x15 global_with_exf global_ocean_pressure 
    inverted_barometer solid-body.cs-32x32x1
  (high order AdvScheme and/or multiDimAd works with Olx=Oly=2 ? not sure)

checkpoint48d_post
o in preparation for r*:
 a) use pre-computed gradient of hydrostatic potential:
    changes in timestep.F & mom_cdscheme.F affects results of ideal_2D_oce
 b) move phi0surf from calc_phi_hyd to calc_grad_phi_hyd:
    => affects results of glob_oce_pressure (different truncation error)  
  update output.txt of ideal_2D_oce & global_ocean_pressure

checkpoint48d_pre
o in preparation for r*:
  new S/R (calc_grad_phi_hyd.F) to compute Hydrostatic potential gradient.
  pass the 2 comp. of the grad. as arguments to momentum S/R.
  but for the moment, only used if it does not change the results. 
o add finite volume form of calc_phi_hyd for buoyancyRelation OCEANIC & OCEANICP

checkpoint48c_post
Modifications in treatment of initial flux forcing controls
to avoid extra storing of flux fields.

checkpoint48c_pre
o Added tidal_basin_2d experiment (currently 1D!)
o can use r* Coordinate with OBC (but Orlanski Rad. BC not yet implemented) 

checkpoint48b_post
o r* coordinate added in #ifdef NONLIN_FRSURF block.
 (modification to pressure gradient not yet implemented)
o mom_fluxform: new S/R mom_calc_rtrans.F computes vertical transports
  (for U & V) that are used for vertical advection of momentum.

checkpoint48a_post
o In preparation for r*, use temp. array to compute vertical transport
   in flux-form momentum pkg. => change results of few test-exp. 
  Update output of: exp4, exp5, front_relax, global_ocean_pressure, 
                    lab_sea, natl_box & plume_on_slope

checkpoint48
o fix small bug that was causing lot of warning (TIMER_STOP 'UPDATE_CG2D')

checkpoint47j_post
o add new exp. (ideal_2D_oce) to test "exotic" parameters and options.
o moved adexch from forward_step to addummy_in_stepping
o added exch in ctrl_map_...
o aveFreq.=0. at end of cost_final to avoid overwrite in
  reverse checkpointing loop
o Yet more changes in gmredi:
  * adgmredi_calc_tensor
    avoiding all recomputation of gmredi_slope_limit
  * adgmredi_x/y/rtransport
    added flag for excessive storing to avoid recomp. of
    u/v/rtans, dTdx/y/z
    -> this is not really necessary and very memory-consuming
  * adgmredi_slope_psi:
    consistency with gmredi_slope_limit in treatment of GM_slopeSqCutoff
  * gmredi_slope_limit
    re-activated full calculation of taperfct for case 'ac02'
o updating verification/ adjoints of carbon, global_ocean.90x40x15

checkpoint47i_post
o GM_EXCLUDE_() replace GM_TAPER_(): by default, all the code is compiled.
o add GM_Small_Number & GM_slopeSqCutoff as run-time parameters (data.gmredi)
  default values = 1.D-12 & 1.D+48 (=> give same results as checkpoint47f_post)
o cg2dTargetResWunit: define tolerance using deltaTmom (and not deltaTfreesurf) 
o gmredi: fix few bugs.

checkpoint47h_post (duplicate tag for PH's c48 tag, in order to move c48)
This will be a good checkpoint to plug into the ecco-branch.
o few modif.'s to get latest version adjointed
  (mainly kick out code in ini_linear_phisurf)
o modif's to run adjoint with exactConserv
o case GM_BOLUS_ADVEC should be cleaned
  S/R gmredi_slope_psi should be cleaned
o verification/carbon now has exactConserv=.TRUE.

checkpoint47g_post
o time-average AIM output: becomes independent from statvars time-average
  (can be used with #undef ALLOW_TIMEAVE) ; add new variables (e.g., RH)
o After TAF bug fix:
  Tested adjoint of gmredi package.
  Tests were done with checkpoint47 rather than with latest
  checkpoint47f_post since the latter is broken for the adjoint
  verification/carbon/ contains both ADM and TLM gradient checks.
Here they are, before they get changed/lost/stolen.
Mostly modif.'s to fix numerical sensitivities.
Gradient checks OK for
- GM_taper_scheme:
  * clipping
  * ac02
  * linear
  * glw91
  * dm95
  * ldd97
- GMREDI_OPTIONS:
  * GM_VISBECK_VARIABLE_K
  * GM_NON_UNITY_DIAGONAL
  * GM_EXTRA_DIAGONAL
  * GM_BOLUS_ADVEC
in conjunction with data.gmredi parameters to be checked in
in a few minutes under verification/carbon/code/

checkpoint47f_post
Merging from release1_p10:
o modifications for using pkg/exf with pkg/seaice
  - pkg/seaice CPP options SEAICE_EXTERNAL_FORCING
    and SEAICE_EXTERNAL_FLUXES
  - pkg/exf CPP options EXF_READ_EVAP and
    EXF_NO_BULK_COMPUTATIONS
  - usage examples are Experiments 8 and 9 in
    verification/lab_sea/README
  - verification/lab_sea default experiment now uses
    pkg/gmredi, pkg/kpp, pkg/seaice, and pkg/exf

checkpoint47e_post
o created a tag prior to creating a branch

checkpoint47d_post
o fixed bug in the oceanic pressure coordinates code: vertical viscosity 
  at the bottom boundary had an erroneous half slip boundary condition
o added bottom drag and no slip boundary condition capabilities to 
  oceanic pressure coordinates code
o added new verification experiment global_ocean_pressure, this experiment is
  also described in the tutorial section of the manual
checkpoint47d_pre

checkpoint47c_post
o Added a verification experiment for a global cubed-sphere ocean run
  -  verification/global_ocean.cubed32x32x30
  -  uses pkg/therm_seaice and pkg/bulk_forcing

o allow to run AIM physics with SPEEDY input files (from Franco Molteni)
o allow a more accurate definition of Ro_Surf (selectFindRoSurf=1)
  when using P-coordinate; only implemented for atmospheric config.
o OCEANICP & realFreshWater: include P-E direct effect on wVel ;
  NOTES: requires option NONLIN_FRSURF to be "#define".
o update advect_xz/results/output.txt (left from checkpoint44g_post)

checkpoint47b_post
Merging from release1_p9:
o pkg/seaice
  - removed GOTO's and added taf directives
  - double precision constants to reduce the g77 (Linux)
    to F77 (SGI) differences reported in release1_p8
o tools/genmake
  - added SGI options
o verification/testscript
  - updated to that of checkpoint47a_post
o verification/global_ocean.90x40x15/input/eedata
  - modified for SGI f77 compatibility
o verification/lab_sea
  - added description of sea-ice model
  - added missing matlab routines
  - added test of thermodynamics parallelization

checkpoint47a_post
o new pkg: aim_v23 
 = F. Molteni atmos.physics (SPEEDY, ver23) adapted to MITgcm. 
   for now, keep the same surface forcing as before.
 - Part-Cell implemented into AIM; check that Heat & Water are conserved
 - aim.5l_cs: use new aim pkg (run 10yr & get better results than before)
 - aim.5l_LatLon & aim.5l_Equatorial_Channel are still using old aim pkg
o add diagnostic of surface correction term in monitor output

o bulk_force and therm_seaice 
- Two packages:  bulk_force (Bulk forcing)
  and therm_seaice (thermodynamic_seaice) - adopted from LANL CICE.v2.0.2
- Earlier integration from Stephaine Dutkiewicz
  and Patrick Heimbach.
- Two ifdef statements for compile time,
   ALLOW_THERM_SEAICE and ALLOW_BULK_FORCE

checkpoint47
differentiable version of checkpoint46n_post
o bug fix in quasihydrostaticterms
o * "clean" adjoint code (in terms of extensive recomputations)
    can now be obtained for all GMREDI options (i.e. for 
    - GM_VISBECK_VARIABLE_K
    - GM_NON_UNITY_DIAGONAL
    - GM_EXTRA_DIAGONAL
    - GM_BOLUS_ADVEC )
  * However, wrong gradient check problem remains unsolved.
  * New CPP options have been introduced for different
    tapering schemes
o external_fields_load now part of differentiation list
o pressure needs multiple storing;
  would be nice to have store_pressure at beginning or
  end of forward_step, e.g. by having phiHyd global (5-dim.)
  (NB: pressure is needed for certain cases in find_rho,
  which is also invoked through convective_adjustment).
o recomputations in find_rho for cases 
 'JMD95'/'UNESCO' or 'MDJWF' are OK.
o #define ATMOSPHERIC_LOADING should be differentiable
o ini_forcing shifted to begining of initialise_varia
o Incorporating QNVS line search routines into MITgcm
  (this is separate code, and therefore not under pkg)
  lsopt/, optim/
o Updated verification/carbon/
  - #define GM_VISBECK_VARIABLE_K
  - GM_taper_scheme    = 'ldd97'    

checkpoint46n_post
Merging from release1_p8:
o verification/natl_box:
  updating new external_fields_load routine
o New package: pkg/seaice
  Sea ice model by D. Menemenlis (JPL) and Jinlun Zhang (Seattle).
  The sea-ice code is based on Hibler (1979-1980).
  Two sea-ice dynamic solvers, ADI and LSR, are included.
  In addition to computing prognostic sea-ice variables and diagnosing 
  the forcing/external data fields that drive the ocean model, 
  SEAICE_MODEL also sets theta to the freezing point under sea-ice.
  The implied surface heat flux is then stored in variable 
  surfaceTendencyTice, which is needed by KPP package (kpp_calc.F and 
  kpp_transport_t.F) to diagnose surface buoyancy fluxes and for the 
  non-local transport term.  Because this call precedes model 
  thermodynamics, temperature under sea-ice may not be "exactly" at 
  the freezing point by the time theta is dumped or time-averaged.
  N.B.: fairly large differences in accuracy occur across
        different platforms/compilers; comparison between
        g77 (Linux) and F77 (SGI Origin 2000/MIPSpro) 
        generated output gives:
   T           S           U           V
  C D M    c        m  s        m  s        m  s        m  s
  n p a R  g  m  m  e  .  m  m  e  .  m  m  e  .  m  m  e  .
  f n k u  2  i  a  a  d  i  a  a  d  i  a  a  d  i  a  a  d
  g d e n  d  n  x  n  .  n  x  n  .  n  x  n  .  n  x  n  .

  Y Y Y Y  5  5  7  7  7  8 10  9  6  6  6  6  7  5  7  5  7 FAIL  lab_sea
o GAD: 
  - generated new common blocks to account for call of
    same gad routines with differing traceridentities
    (needed to modify tracerIdentity indices in GAD.h)
  - generated separate common blocks for case useCubedSphereExchange
    (Department of Futurology)
  - parameter lists to gmredi_?transport: added tracerIdentity
  - added new key indices to tamc.h
o external_fields_load:
  - added this routine to TAF list
  - needed to make some common blocks global and additional storing
    along the same lines as exf package (checkpoint_lev?_directives.h)
o exf:
  updated external forcing package
  - bug fixes carried over from ecco-branch
    (missing OBCS_OPTIONS.h in two routines)
  - enable easy to use "no forcing".
  - added exf I/O for atmospheric loading
  - added exf I/O for runoff data
  - transfered scaling between exf <-> MITgcm to exf namelist
o Adding new verification experiment global_with_exf.
  This verification experiment is almost identical to the
  global_ocean.90x40x15 experiment, except that it uses
  the exf (and cal) package instead of the
  external_fields_load routine (cf README file).

checkpoint46m_post
o modified testscript to return -- when there are no lines of "%MON" output 
o added new flag "quasiHydrostatic" for QH mode
  and new routine quasihydrostaticterms()
o added 2*Omega*Cos(phi)*W to u equations (non-hydrostatic Coriolis term)
  New routine: mom_u_coriolis_nh()
o fixed sign of non-hydrostatic metric terms in u and v equations.
  Depend on correct sign of gravitySign.
o added work.pc* to .cvsignore in aim directories using ifc
o introduced flag for controllin non-hydrostatic metric terms
o removed gravitySign from PARM04
o switched to g77/ifc from pgf77 in aim experiments

checkpoint46l_post
o made convective adjustment work with pressure coordinates:
 - changed the direction of k-loop in convective_adjustment.F for the
   case of pressure coordinates (OCEANICP,ATMOSPHERIC buoyancyRelation)
 - adjusted the reference pressure k-index in convective_adjustment.F
 - adjusted the convection condition in convect.F (in analogy to
   calc_ivdc.F)
 - convective_adjustment no longer computes anything on the halos
 - removed the warnings about negative salinity from find_rho.F and
   find_alpha.F; instead the new routine look_for_neg_salinity, called
   at the beginning of find_rho, find_alpha, and find_beta, does a 
   check of the entire slice, if CPP-option 
   CHECK_SALINITY_FOR_NEGATIVE_VALUES is defined
checkpoint46l_pre

checkpoint46k_post
o fixed the verification/global_ocean.90x40x15 experiment:
 - new bathymetry (the world according to A., JMC, and M.)
 - new initial fields and forcing fields (*.bin files)
 - new POLY3.COEFFS (for the next release one should switch to a full
   equation of state: JMD95P or MDJWF)
 - fixed several errors and redundancies in the data file
 - experiment uses looped cells
 - added matlab directory with diagnostic scripts for plotting of output

o S/R aim_initialise.F replace S/R aim_init from file aim_do_inphys.F:
 - read AIM physics parameters from a file (data.aimphys)
 - set defaults values = F.Molteni paper (Clim.Dyn., 2002)

checkpoint46j_post
o split calc_exact_eta in 2 S/R : integr_continuity & update_etaH
o move wVel computation at the end of the time step, in S/R integr_continuity
o create specific S/R to exchange T,S before DYNAMICS (for stagger time step)
o update timeave pkg for wVel diagnostic.
checkpoint46j_pre

checkpoint46i_post
o Clean up AIM package (and keep the results unchanged):
  include CPP_OPTION and use IMPLICT NONE in all routines ; 
  declare all the variables _RL ; use _d 0 for all numerical constants.
  use ifdef ALLOW_AIM everywhere. And now AIM can be used with g77 !

checkpoint46h_post
o cleaned up the use of rhoNil and rhoConst. 
  - rhoNil should only appear in the LINEAR equation of state, everywhere 
    else rhoNil is replaced by rhoConst, e.g. find_rho computes rho-rhoConst
    and the dynamical equations are all divided by rhoConst
o introduced new parameter rhoConstFresh, a reference density of fresh 
  water, to remove the fresh water flux's dependence on rhoNil. The default
  value is 999.8 kg/m^3
o cleanup up external_forcing.F and external_forcing_surf.F
  - can now be used by both OCEANIC and OCEANICP
checkpoint46h_pre

 Added code to convert surface volume flux (fresh water) into
 a mass flux when using P coordinates in the ocean (OCEANICP).
 Note: It assumes you have set rho0=rhoConst=density of fresh water.

checkpoint46g_post
o Include a new diagnostic variable phiHydLow for the ocean model
  - in z-coordinates, it is the bottom pressure anomaly
  - in p-coordinates, it is the sea surface elevation
  - in both cases, these variable have global drift, reflecting the mass
    drift in z-coordinates and the volume drift in p-coordinates
  - included time averaging for phiHydLow, be aware of the drift!
o depth-dependent computation of Bo_surf for pressure coordinates 
  in the ocean (buoyancyRelation='OCEANICP')
  - requires a new routine (FIND_RHO_SCALAR) to compute density with only 
    Theta, Salinity, and Pressure in the parameter list. This routine is 
    presently contained in find_rho.F. This routine does not give the
    correct density for 'POLY3', which would be a z-dependent reference
    density.
o cleaned up find_rho
  - removed obsolete 'eqn' from the parameter list.
o added two new verification experiments: gop and goz
  (4x4 degree global ocean, 15 layers in pressure and height coordinates)
checkpoint46g_pre

checkpoint46f_post
o Enable tangent linear (forward mode) gradient checks:
  - extended active file handling to g_... files
  - added TANGENT_SIMULATION to theSimulationMode
  - extended grdchk package accordingly
o added tangent linear setup in verification/carbon/code_ftl
o added adjoint setup in verification/front_relax/code_ad

checkpoint46e_post
o Added new equation of state -> MDJWF
  - EOS of McDougall et al., 2002, JAOT, submitted
  - caveat: the equation of state is only valid for a smaller (more
    realistic?) range of values than JMD95P/Z and UNESCO
  - added masks to the calculation of pressure in store_pressure
  - added more check values for density in check_eos (ini_eos.F), some of 
    the old check values are out of the range of the MDJWF-eos, so don't
    expect perfect matches for those 
checkpoint46e_pre

checkpoint46d_post
o fixed store_pressure to work with both buoyancy relation = 'OCEANIC' and
  'OCEANICP', also initialised field pressure correctly in ini_eos in the 
  case of pressure coordinates. eosType='JMD95Z' in 
  combination with buoyancyRelation='OCEANICP' now causes an error.
o Changed p = pressure(i,j,k,bi,bj)  to  p = pressure(i,j,kRef,bi,bj)
  in find_alpha/beta.
checkpoint46d_pre

o Changed p = pressure(i,j,k,bi,bj)  to  p = pressure(i,j,kRef,bi,bj)
  so that JMD95Z and JMD95P give approptiate static stability in find_rho. 

checkpoint46c_post
o Changes necessary for ocean in p-coordinates
 -  Added new buoyancy relation = 'OCEANICP'
 -  Added new parameters = gravitySign (this used to be contained inside
    the factor dRdZ which I added when we first switched to R coordinates).
 X GM/Redi is not compatible (yet)
 X bottom drag and no-slip need to be debugged.
checkpoint46c_pre

checkpoint46b_post
o Added new equation of state -> JMD95Z and JMD95P
  - EOS of Jackett and McDougall, 1995, JAOT
  - moved all EOS parameters into EOS.h
  - new routines ini_eos.F, store_pressure.F
o Added UNESCO EOS, but not recommended because it requires 
  in-situ temperature (see JMD95)
o Modified formatting for knudsen2.f in utils/knudsen2 and added
  unesco.f to be used with POLY3
checkpoint46b_pre

checkpoint46a_post
o Added (atmospheric) pressure loading
  - new field in FFIELDS.h, etc...
  - new cpp flag ATMOSPHERIC_LOADING
o Changed hFacC to _hFacC in calc_phi_hyd.F
o Added SHORTWAVE_HEATING to some files for consistency
checkpoint46a_pre

checkpoint46
further merges from release1_p5
o new ctrl package
  - adopted from ECCO environment to enable optimization
  - added Eliassen Palm fluxes to controls
o added Eliassen Palm flux controls to gradient check package
o cost package
  - Compatible with new ctrl package
  - added Eliassen Palm cost hooks
  - modif's of existing cost functions
o Adjoint-related bug fixes in kpp:
  - kpp_calc: sore of kpphbl avoids recomputation/call to S/R kppmix
  - kpp_routines: store of Rib avoids partial recomputation bug of TAF.
o autodiff package
  - flow directives:
    + new for S/R do_the_model_io
    + enhanced for S/R checkpoint
    + new gmredi.flow
  - Introduced CPP option ALLOW_AUTODIFF_MONITOR to
    disable adcommon.h/g_common.h by default.
  - fixed problem for adjoint of global_max
o modified verification/carbon/
o New setup for adjoint of global_ocean
o added hooks for Eliassen Palm fluxes (dynamics.F, ini_fields.F)
o cleaned TAF keys iikey, idkey (dynamics.F, thermodynamics.F)
o incorporated hooks for sponge layer code (external_forcing.F)

checkpoint45d_post
o import 2 fixes from release1_p5 (CG2D.h & packages_readparms.F)
o use recip_dx*,recip_dy* instead of /dx*,/dy* in orlanski_E,W,N,S
  (affects plume_on_slope "cg2d" output)
o add new parameter deltaTfreesurf for free-surface time stepping
o exchange gT,gS when using staggerTimeStep & GM & Oly<4 
o NONLIN_FRSURF: rescale gNm1 to get a better conservation with A-B
o change phiMin in exp1 (to agree with documentation)
o add new flags: 
 - T,S forcing inside/outside Adams-Bashforth
 - turn off temp,salt advection and/or forcing
 - for each tracer, define internal flag for multiDimAdvection & A-B
o monitor: change definition of KE to check conservation of Energy

checkpoint45c_post
o Removed f90 comments ("!")
o Modified initialisations to enable exf package for MITgcm
  (without invoking ECCO_PACKAGE).
o modifications to gradient check package (Martin Losch)
  - enable centered differences
  - modified format of standard output

checkpoint45b_post
o cleaned exchange calls in cg2d
o Included CPP option ALLOW_AUTODIFF_MONITOR in forward_step
o included CPP option SINGLE_LAYER_MODE in thermodynamics
  to configure barotropic setup (Martin Losch)
o moved some initialisations within bi,bj loop in dynamics
  (TAF flow dependency)
o in initialise_varia, moved call packages_init_variables
  before convective_adjustment_init
  (corresponding adjustment of TAF tape initialisation).
o in calc_diffusivity/calc_viscosity extended domain to full overlap.

checkpoint45a_post
o compute Rho over the whole domain (extend iMin,jMin indices)
o specific exchange for X-slice domain (case Ny=1)
o argument futureIter of S/R obcs_calc missing in exp4 & internal_wave /code
o solve_for_pressure : set cg2d_x to zero where OBCS are applied

checkpoint44h_post = checkpoint45
o Fix to restore differentiability:
  place at which packages_init_variables is called in
  initialise_varia is crucial for reverse control flow.
o modifications in GMRedi to enable stable adjoint
  (corresponding modif's in thermodynamics, dynamics)
o added missing hook for sponge layer code in external_forcing
o modified test cost functions
o storing in gad_advection (plus removal of write(0,*)!
o missing headers TR1.h added in convective_adjustment routines
o errorMessageUnit set non-equal zero in eeboot
  (conflict on some platforms, e.g. IBM SP3)
o modified carbon verif.

checkpoint44h_pre
o vertical grid option: allow to put the Interface at the middle between
  2 cell-centers ; replace delZ in pkg/kpp by drF.
o GM Advective form: Tracers are advected using the residual transport (=
  Euler+GM-bolus); set param GM_AdvSeparate=T to return to previous form.

checkpoint44g_post
o fix surface correction term in multiDimAdvection (affects plume_on_slope 
  results) ; ifdef missing in thermodynamics.F

checkpoint44f_pre,checkpoint44f_post
o added PTRACERS package
  This allows an arbitrary number of passive tracers to be integrated
  forward simultaneously with the dynamicaly model.
  + Implemented so far:
    - basic forward algorithm (time-stepping, advection, diffusion, convection)
    - I/O and checkpointing
    - GM/Redi  *but*  using the GM/Redi coefficient of Salt
  + Not implemented so far:
    - KPP
    - OBCS
  + No specific example supplied (yet) but global_ocean.90x40x15 has the
    necessary data.ptracer file. Simply use -enable=ptracers and uncomment
    line in data.pkg.
  + This package is disabled by default since it increases storage.


o testscript: added -cleanup option
o Shap_filt: a) new shap_filt S/R to use no-slip BC with S2 filter
             b) enable to filter 2D fields.

checkpoint44e_pre,post
o re-wrote convective adjustment to use pre-calculated weights
  Affects: model/src/convective_adjustment.F, convective_adjustment_ini.F
  Adds:    model/src/convective_weights.F, convectively_mixtracer.F
  Original calls to convect() still in place.

chkpt44d_pre,post
o added missing EXCLUDE_MONITOR flags
o changed "e" to "_d" in gmredi_slope_limit, gmredi_slope_psi
  (incompatible typ in MIN/MAX expressions caused problems
  on IBM SP3)
o in genmake added variable MAKEDEPEND
  plus resetting for case SunOS
o added timer_stats.c routine for IBM SP3
o removed variables in dynamics
!!! I forgot to create tag chkpt44d_pre !!!
!!! But chkpt44d_pre = chkpt44c_post    !!!

o real fresh water flux implemented with non-linear free-surface.

chkpt44c_pre,post
o few fix (mask in shap_s2, EmPmR in external_field_load, 
  USE_NATURAL_BCS in solve_for_P); 
o add arguments myIter & myTime to S/R obcs_calc & solve_for_P

checkpoint44b_pre/_post
o merge of relevant stuff from the ecco-branch:
  - genmake: removed $S64 overwrite for case SunOS
  - pkg/exf: update and corrections for field swapping and obcs
  - pkg/ecco: parameter lists for the_model_main, the_main_loop
              harmonized between ECCO and MITgcm
  - pkg/autodiff: added flow directives for obcs, mdsio_gl_slice
                  updated checkpointing_lev... lists for obcs
  - model/src: minor changes in forward_step, plot_field
               added directive for divided adjoint in the_main_loop
  - pkg/mdsio: added mdsio_gl_slice

o check parameters & config (chkpt44a_pre,post)
o OBC and NonLin_FrSurf.

checkpoint44
o fix bug in mom_vi_del2uv
o select when filters are applied ; add options to zonal_filter (data.zonfilt)
o gmredi: fix Pb in the adiabatic form ; add options (.e.g. Bolus advection)
o update AIM experiments (NCEP input files)
o improve and extend diagnostics (Monitor, TimeAve with NonLin-FrSurf)
o added some stuff for AD

checkpoint43
o added two new advection tests
o added global 4x4 degree ocean test
o added test of H&S94 with free surface on cube
o some final mods for gradient check, adjoint,...

checkpoint42
  Fixed AD-related problems:
o Store directives up-to-date with re-arranged Adams-Bashforth
  (mainly thermodynamics.F)
o New store directives for multi-dim. advection schemes
  * new CPP flag ALLOW_MULTI_DIM_ADVECTION
  * new common block and key passkey
  (mainly gad_advection.F)
o Modified store directives for split of dynamics/thermodynamics
  for the case ALLOW_KPP
o Cleaned argument list for timestep_tracer.F

checkpoint41
o re-formatted/added comments in prologues of key subroutines
  to work with protex

checkpoint40
o moved calc_gs, calc_gt and calc_tr1 back to model/src
o added FLT (floats) package from Arne along with demo. experiment
o re-arranged Adams-Bashforth scheme for tracers to allow easier
  implementation of forward-in-time forcing terms
o more mods for non-linear free-surface including new variable
o modified multi-dim method to work on cube
o bug fix in KPP (from DM)

checkpoint40pre9
o added DST advection schemes
o fix MPI bug on SGI's
o modifications for non-linear free-surface
o fixed conditionals for fixed flow/passive tracer only mode
o added tension/strain form of stress tensor
o changes to commenting of arguments for TAF/TAMC
o added/updated many matlab scripts
o added multi-dimensional advection method for tracers
  
checkpoint40pre8
o new package rw/
  Added method for dumping intermediate local arrays:
  mdsio_writetile - same as mdsio_writefield except works from inside
                    bi,bj loop
  mdsio_writelocal - same as mdsio_writetile except works for local
                     arrays
  write_local_r? - higher-level wrapper for mdsio_writelocal
  Controlled by diagFreq. Defaults to zero (ie. no dumps)
  Example given at end of mom_vecinv.F that dumps some local arrays.
o replaced calc_mom_rhs.F by mom_fluxform.F/mom_vecinc.F to
  control flux-form versus vector invariant code.
  Switch is runtime flag vectorInvariantMomentum (defaults to false)
  or genmake -DISABLE ...
o TAMC-related update to cope with mom_fluxform.F/mom_vecinc.F
  (additional storing is now needed for case vecinv;
  currently nothing implemented to switch this storing off
  in case fluxform is used since no CPP flag available).

checkpoint40pre7
o bug fix in dynamics.F
  calc_viscosity called before k=1,Nr loop.
o added some #ifdef's ALLOW_PASSIVE_TRACER
o cleaned initialisations in ctrl_map_ini
  related to TAF

checkpoint40pre6
o split dynamics into thermodynamics & dynamics
o corresponding split of calc_diffusivity into
  calc_diffusivity, calc_viscosity
  (kpp_calc_diff, kpp_calc_visc).
o Added diffkr, kapgm to control variables
o bug fix in gmredi_slope_limit for ldd97

checkpoint40pre5
o proper initialization of Adams-Bashforth time stepping
  + uses forward step for very first step of model (iter=0)
o re-generated *all* output since almost all output is modified by this
  change (sorry but we've been putting this one off for about 2 years)
  + natl_box, aim.5l_Equatorial_Channel and aim.5l_zon-ave were
    *not* regenerated since they are already out of date and I don't
    want to create the impression that they are suddenly working.
o removed KAP stuff for DEC's
o modified/added many .cvsignore files in */code and */input
o added new expt "solid-body.cs-32x32x1"
  + this uses an alternative form of ini_curvilinear_grid.F which
    is not necessarily any better than the current one...

checkpoint40pre4
o added re-initialisations of utrans,vtrans,rtrans in
  calc_common_factors which are crucial for TAF.
o extended iMin,jMin range for calc_common_factors,
  calc_diffusivity
o added option ALLOW_PASSIVE_TRACER
o a few minor updates and fixes

checkpoint40pre3
o created calc_gtr1.F for gad package
o split the_main_loop and re-introduced forward_step
o some recomputations of nIter0 for TAMC

checkpoint40pre2
o Updated to latest branch of AJA, JMC
o Added gradient check package
o Added routines for passive tracer handling
o Added carbon sequestration sensitivity experiment

checkpoint39
 o Modifications and fixes to support TAMC
   (mainly missing or wrong directives)
 o Corrected common blocks when fooling TAMC to produce adjoint I/O
   in addummy_in_stepping
 o Updated verification/vero/ (bug fixes in code/, correct pickups in input/)
 o Enabled "sliced" (xz-,yz-) exchanges, needed for obcs.
 o Included following packages:
   cal: calendar
   exf: external forcing
   ecco: essential routines to control use of cal, exf
         (NB: this is not the full ECCO environment)
 o disabled some packages by default in genmake

checkpoint38
 o see notes_c37_adj.txt
 o corrected wrong layer index in external_forcing_t
 o replaced the_main_loop/forward_step by the_main_loop
 o removed forceoutput from write_state
   (replaced criteria for initial/final state)
 o added runtime flag for pre-C35 pickups: usePickupBeforeC35

checkpoint37
 o mdsio.F routine split and packaged in pkg/mdsio
   (mdsio.F and mdsio_gl.F still exist in eesupp/src but are not
    used unless genmake -disable=mdsio)
 o allow a more precise surface-geopotential gradient for the atmosphere
   taking into account the change in space of Alpha (=1/rho) at the surface.
 o variable "etaN" (replace cg2d_x) is the surface R-anomaly [r unit]
   (ocean: sea surface height [m] / atmos: surface pressure anomaly [Pa])
 o Change units: Phi_Hydrostatic (=phiHyd), Phi_Surface(=cg2d_x) and
   Phi_NonHydrostatic (=cg3d_x), all have now the dimension of a potential
   [m2/s2] (pressure/rhoConst in the ocean ; Geo-Potential in the atmosphere).
 o Time-Average diagnostics defined as a pseudo package "timeave".
 o pickup files : old pickup (before c35) did not work with new code (c35
   and after) unless activating 2 commented lines in initialise-varia.
 o Non-Hydrostatic pickup file Pb fixed.
 o bug with Rigid-lid version (since c35) fixed.  

checkpoint36
 o implement Crank-Nickelson barotropic time-stepping
 o recover Time-Average diagnostics
 o fix Pb in checkpoint (PR#19) 
 o AIM become a standard package ; clean unused CPP_kees

checkpoint35
 o subtantial rewrite of dynamics.f
 o allows staggered time-stepping
 o packaged obcs, aim (Atmospheric Physics), zonal_filt, shap_filt
 o added bottom drag (linear + quadratic)

checkpoint34
 o Modified exchange routines for correct reverse simulation.
 o Added verification output to comply with bug fix in impldiff.F
   as of c33 (exp2, natl_box).
 o Corrected store directives in dynamics.F
 o Corrected array boundaries in impldiff.F
 o Corrected array dimensions in gmredi.
   Added temporary scalars to avoid storage by TAMC (gmredi, kpp).
 o Added routine GLOBAL_SUM_INT to global_sum.F
 o Added mdsio_gl.F for ECCO purposes.

checkpoint33
 o Fixed bug in lower BC in impldiff.F
 o Fixed confusion about units of forcing arrays in FFIELDS.h
   namely Fu,Fv,Qnet,Qsw,EmPmR:
   - Removed verification/natl_box/code/external_fields_scale.F
     (did not differ from that in model/src)
   - Changed units of fu,fv,Qnet,Qsw,EmPmR back to proper units
     (see FFIELDS.h for description)
   - Scale fu,fv,Qnet,Qsw,EmPmR when used in external_forcing_surf.F,
     kpp_calc.F and kpp_transport_t.F
   - Removed model/src/external_fields_scale.F and calls to it
   - verification/natl_box uses flux data with "atmospheric" sign so
     a special version of external_fields_load.F is used to
     change the data as it's read in. This way, the arrays
     have the right units and signs at all times tha a user could
     possibly use them.
 o Corrected genmake to delete a temporary file during configuration

checkpoint32
 o Scaling of forcing fields moved from external_forcing.F to
   external_fields_scale.F, called directly after loading fields.
 o Surface relaxation terms added to surface tendency fields in
   extra subroutine.
 o impldiff.F changed to avoid storing by TAMC of huge intermediate
   fields.
 o Changes in GMRedi to comply with packaging structure.
 o Modifications and bug fixes in KPP package.
 o Verification experiment for KPP added (verification/nat_box/)

checkpoint31
 o Packages interface brought in line with defined standard
   -> new routines packages_...F
   -> changes in initialise_fixed.F, initialise_varia.F
   -> enables initialisation interface for ECCO package
 o Rescaling of external forcing fields immediately after read
   (removed from external_forcing.F) 
   -> new: surface_fields_scale.F
   -> affects ini_foorcing.F, external_fields_load.F
 o Computation of surface tendencies before tendency updates.
   -> new: external_forcing_surf.F
 o Change of variable names useGMRedi, useKPP, useECCO
 o Further changes in dynamics.F, impldiff.F for TAMC
 o Tested for experiments 0, 2, 4.
   - not yet tested for GMRedi.
   - not yet tested for KPP.

checkpoint30
 o Updates for OBCs
 o New experiment for test OBCs (internal_wave)
 o New output.txt in verification/exp4/results/
 o Updates for KPP: calculation of viscosity corrected, new variables
   kpp_dumpFreq and kpp_taveFreq
 o CPP'd calls to system routines for TARGET_CRAY_VECTOR (P.H.)
   and entry for T90 in genmake

checkpoint29
 o packaged KPP and GM/Redi

checkpoint28
 o Corrected initialization of hFacMin for difference vertical coordinates
 o Modified calculation of partial cell thickness to more robust algorithm
 o config_summary.F: replaced write_1D_... by write_0D_...
   read_write.F: added subroutines write_0D_...
 o routines calc_common_factors, calc_gs, calc_gt, calc_phi_hyd, find_rho:
   included some initialisations required for TAMC.
 o routine calc_isoslopes: modified sqrt computation to make it 
   differentiable for zero argument.
 o routines dynamics, impldiff:
   included store directives and tape key computations required for TAMC.
 o ALL TAMC related changes are between ifdef ALLOW_AUTODIFF_TAMC

checkpoint27
 o fixed calc_isoslopes() to so that cancellation of terms in tensor
   formulation works properly with variable resolution.
 o restructured the calling tree between the_model_main() and dynamics()
 o split initialise() into initialise_fixed() and initialise_varia()
 o introduced initialization file pSurfInitFile for free surface (cg2d_x)
   in new routine ini_psurf()

checkpoint26
 o moved some #ifdef in optional routines to encompass everything
   except the argument declarations. This was using up some memory.
 o fixed macros like _ADT to work with both versions of Linux cpp
 o cleaned up some unused and uninitialized variables
   (helps when debugging with strict compile options)
 o split up CPP_EEOPTIONS.h into options and macros
   (macros are now in eesupp/inc/CPP_EEMACROS.h)
 o patch for 2 processor JAM mode

checkpoint25
 o updates for OBCs and NH
 o dramatically reduced memory usage
 o added "JAM" routines for use on Artic network
 o parameterization of convection by implicit vertical diffusion
 o added a diagnostic of convective index
 o moved call to calc_divg_hat() from dynamics() to solve_for_pressure()
   (this is was partly for OBCs and NH but also in anticipation of
    an explicit free-surface option)
 o initial state input files for U and V

checkpoint24
 o Removed some spurious "REAL"s
 o Updated KPP to latest version from JPL
 o Added a COS(latitude) in horizontal viscosity

checkpoint23
 o Added del^4 diffusion for salt and temperature
 o Multiple minor fixes (implicit none's, arguments to global_sum, etc.)

checkpoint22
 o Made many small changes: implicit none, format(i5), etc...
 o Introduced KPP mixing scheme (compiles and runs but *not* tested)

checkpoint21
 o Introduced new I/O package that supports direct-access records (mdsio.F)
 o Split-up mid-level I/O routines
 o Updated input data for experiments 0,1,2,4 and 5
 o Finally removed the genmake.* scripts (everyone seems happy with genmake)

checkpoint20
 o Tidied up open-boundaries some more
 o Added non-hydrostatic code
 o Fixed some input data
 o Modified MPI start-up to work in "coupled" context.

checkpoint19
 o Tidied up directory structure for verification experiments.
 o Added new code for open boundaries.
 o Corrected advective terms near boundaries.
 o Added CPP flag for "old UV" geometry and corrected spherical geometry.
 o Implemented free-slip/no-slip BCs and del^4 dissipation.
 o Split default parameters out of ini_parms.F into set_defaults.F.

checkpoint18
 o Further changes for optional code generation with 
   CPP - ugh!

checkpoint17
 o Beginning to incorporating modularity
   for supporting atmos. and ocean configs.
 o Small changes for TAMC complinace
 o New ultra simple test case. Barotropic box
   configuration "exp0".

checkpoint16
 o Minor changes to exchange routines to support 
   accumulation in reverse mode. Adjoint of an
   assignment is an addition.
 o Changes to support compilation by TAMC (LR(1) 
   syntax) and by g77 under Linux ( 72 character
   limit ).

checkpoint15
 Rewrote exchange routines to allow
 o General tile <-> tile connectivity.
 o TAMC reverse mode flag ( is this really needed? )
 o Variable width overlap and exchange region widths.
 o Hooks for sharing data via DMA, Arctic, Memory Channel, 
   shmput/shmget, VIA, SYSV shmem and every other cool 
   communication method.

checkpoint14
 Consistent isomorphism chages made. These allow dynamical core
 to support both pressure and meters as a vertical coordinate.

checkpoint13
 Release which corrects global_max problem and a couple
 of KGM time-averaging diagnostic errors. Also contains
 a double-gyre experiment setup as well as the baseline
 4 degree global template. The double gyre template is
 organised to allow it to be applied automatically to
 the baseline configuration.

branch-point-rdot
 A few tidy-ups have been made bt the real point of this
 check-point (excuse the pun) is to allow a branch to be
 made for the purposes of adding the rDot alterations.
 I don't want to commit the rDot to the main-trunk until
 we've actually tested it...

checkpoint12
 Tidy up and added generic genmake script (formerly
 configure script). 
 Released to testers.

checkpoint11
 Re-arranged initialise() and introduced ini_vertical_grid()
 and ini_masks_etc().

checkpoint10
 Introduced the configure script.
 Separated out the diags package.
 Added template for writing time-averages of tile/intermediate quantities.
 Updated SIZE.h in exp2 and made the data big-endian.

checkpoint9
 MPI fix. Filename changes (meta/data). salbin*y stuff.
 General tidy-up.
 SST.bin SSS.bin added to verification/exp2

checkpoint8
 Inludes time-dependant forcing and time-averaging.
 Works at 4x4 and 2.8125x2.8125 global

checkpoint7-4degree-ref
 Branch from checkpoint7. Released for application to
 global modeling and general modeling - process studies, regional
 model etc.. 
 Configured for verification/exp2 - 4 degree global, two process.

checkpoint7
 Created by cnh
 Simple 4 degree global simulation 
 configuration.
 Includes climatological wind, 
 hydrography, bathymetry etc
 Does not include Heat Flux and E-P

checkpoint6
 Created by cnh
 merged checkpoint5 with CD and 
 spherical polar code. 
 Still some problems with GM Redi
 abd full topography.

checkpoint5
 Created by AJA
 contains updates to GM Redi
 and reordered timestepping loop
 for Implicit Diffusion.

checkpoint4
 Created by cnh
 Contains memory saving macros ( _rdxc etc..) for when
 grid variations are limited.
 Contains polynomial coeffs for EOS and knudsen program
 for generation.

checkpoint3
 Created by cnh
 Added extra flags for runtime options
 Added this file
 Added implicit free-surface
 Added pre-conditioner
 Put compare01 into repository ( compare01/... )
 Put data and eedata into repository ( verification/exp1 )

checkpoint2
 Created by AJA
 Added GM/Redi

checkpoint1
 Created by AJA
 Restructured kloop in dynamics.F
 Added non-linear EOS

baseline
 Original checked in code

